<!DOCTYPE html>
<html lang="en-US"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/grid-htext-1.0.0/grid_htext.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="author" content="Équipe EAD">
<meta name="dcterms.date" content="2025-04-02">
<title>MA7BY020 - Spring 2025 – Clustering and k-means</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-4ad069d877167e9e682c3e331f3b9002.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script>
  MathJax = {
    loader: {
      load: ['[tex]/boldsymbol']
    },
    tex: {
      tags: "all",
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      packages: {
        '[+]': ['boldsymbol']
      }
    }
  };
  </script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="Clustering and k-means – MA7BY020 - Spring 2025">
<meta property="og:description" content="Analyse de Données Master MIDS">
<meta property="og:site_name" content="MA7BY020 - Spring 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#1c191c" class="quarto-title-block center"><h1 class="title">Clustering and k-means</h1>
  <p class="subtitle"><a href="https://s-v-b.github.io/MA7BY020/">Analyse de Données Master MIDS</a></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Équipe EAD 
</div>
        <p class="quarto-title-affiliation">
            <a href="https://u-paris.fr">LPSM Université Paris-Cité</a>
          </p>
    </div>
</div>

  <p class="date">2025-04-02</p>
</section><section id="TOC"><nav role="doc-toc"><h2 id="toc-title">Roadmap</h2>
<ul>
<li><a href="#/clustering-problems" id="/toc-clustering-problems">Clustering problems</a></li>
<li><a href="#/kleinbergs-theorem" id="/toc-kleinbergs-theorem">Kleinberg’s theorem</a></li>
<li><a href="#/flavors-of-clustering" id="/toc-flavors-of-clustering">Flavors of clustering</a></li>
<li><a href="#/k-means" id="/toc-k-means"><em>k</em>-means</a></li>
<li><a href="#/lloyds-algorithm" id="/toc-lloyds-algorithm">Lloyd’s Algorithm</a></li>
<li><a href="#/lloyds-algorithm-analysis" id="/toc-lloyds-algorithm-analysis">Lloyd’s algorithm (analysis)</a></li>
<li><a href="#/combining-pca-and-k-means" id="/toc-combining-pca-and-k-means">Combining PCA and <span class="math inline">\(k\)</span>-means</a></li>
<li><a href="#/the-end" id="/toc-the-end">The End</a></li>
</ul></nav></section><section><section id="clustering-problems" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Clustering problems</h1>

</section><section id="in-words" class="slide level2 center"><h2>In words</h2>
<p>Clustering consists in <em>partitioning</em> points collections from some metric space</p>
<p>in such a way that</p>
<ul>
<li>points within the same group are close enough</li>
</ul>
<p>while</p>
<ul>
<li>points from different groups are distant</li>
</ul>
<aside class="notes"><p>In the background: some notion of distance/similarity</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="clustering-in-ml-applications" class="slide level2 center"><h2>Clustering in ML applications</h2>
<p>Clustering shows up in many Machine Learning applications, for example:</p>
<ul>
<li><p><i class="fa-solid fa-ad" aria-label="ad"></i> <strong>Marketing</strong>: finding groups of customers with similar behavior given a large database of customer data containing their properties and past buying records</p></li>
<li><p><i class="fa-solid fa-hippo" aria-label="hippo"></i> <strong>Biology</strong>: classification of plants and animals given their features</p></li>
<li><p><i class="fa-solid fa-book" aria-label="book"></i> <strong>Bookshops</strong>: book ordering (recommendation)</p></li>
<li><p><i class="fa-solid fa-car-crash" aria-label="car-crash"></i> <strong>Insurance</strong>: identifying groups of motor insurance policy holders with a high average claim cost; identifying frauds</p></li>
<li><p><i class="fa-solid fa-city" aria-label="city"></i> <strong>City-planning</strong>: identifying groups of houses according to their type, value and geographical location</p></li>
<li><p><i class="fa-solid fa-network-wired" aria-label="network-wired"></i> <strong>Internet</strong>: document classification; clustering weblog data to discover groups of similar access patterns; topic modeling</p></li>
</ul>
<aside class="notes"><p>Many distinct goals: clustering is often just one step in a data analysis pipeline</p>
<p>For recommendation systems, marketing, objects that fit into the same group call for the same action</p>
<p>Some clustering should be hierarchical (toxonomy in life sciences) others can just be flat</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="section" class="slide level2 center"><h2></h2>
<p>A clustering application relies on the elaboration of a <em>metric/dissimilarity</em> over some input space</p>
<p>This tasks is entangled with <em>feature engineering</em></p>
<p>Focus on one specific context: <em>market segmentation</em> <i class="fa-solid fa-chart-pie" aria-label="chart-pie"></i></p>
<ul>
<li><p><i class="fa-solid fa-database" aria-label="database"></i> <strong>Data</strong>: Base of customer data containing their properties and past buying records</p></li>
<li><p><i class="fa-solid fa-bullseye" aria-label="bullseye"></i> <strong>Goal</strong>: Use the customers <em>similarities</em> to find groups</p></li>
<li>
<p><strong>Possible directions:</strong></p>
<ul>
<li><p>Dimension reduction (PCA, CA, MCA, …)</p></li>
<li><p><strong>Clustering</strong> <span class="math inline">\(\approx\)</span> <em>non-supervised classification</em></p></li>
</ul>
</li>
</ul>
<aside class="notes"><p>Are the directions complementary? or not?</p>
<p>Clustering may be done before dimension reduction or the other way</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="dimension-reduction" class="slide level2 center"><h2>
<i class="fa-solid fa-binoculars" aria-label="binoculars"></i> Dimension reduction</h2>
<p>Dimension reduction technologies start form:</p>
<ul>
<li><p>Training data <span class="math inline">\(\mathcal{D}=\{\vec{X}_1,\ldots,\vec{X}_n\} \in \mathcal{X}^n\)</span> (i.i.d. <span class="math inline">\(\sim \Pr\)</span>)</p></li>
<li><p>Space <span class="math inline">\(\mathcal{X}\)</span> of possibly high dimension.</p></li>
</ul>
<p>and elaborate a <em>Dimension Reduction Map</em></p>
<p>Dimension reduction technologies construct a map <span class="math inline">\(\Phi\)</span> from the space <span class="math inline">\(\mathcal{X}\)</span> into a space <span class="math inline">\(\mathcal{X}'\)</span> of <strong>smaller dimension</strong></p>
</section><section id="clustering-techniques" class="slide level2 center"><h2>
<i class="fa-solid fa-binoculars" aria-label="binoculars"></i> Clustering techniques</h2>
<p>Clustering techniques start from <em>training data</em>:</p>
<p><span class="math display">\[\mathcal{D}=\{\vec{X}_1,\ldots,\vec{X}_n\} \in \mathcal{X}^n\]</span></p>
<p>assuming <span class="math inline">\(\vec{X}_i \sim_{\text{i.i.d.}} \Pr\)</span>, and partition the data into (latent?) groups,</p>
<p>Clustering techniques construct a map <span class="math inline">\(f\)</span> from <span class="math inline">\(\mathcal{D}\)</span> to <span class="math inline">\(\{1,\ldots,K\}\)</span> where <span class="math inline">\(K\)</span> is a number of classes to be fixed: <span class="math inline">\(f: \quad \vec{X}_i \mapsto k_i\)</span></p>
</section><section id="dimension-reduction-and-clustering-may-be-combined" class="slide level2 center"><h2>Dimension reduction and clustering may be combined</h2>
<p>For example, it is commonplace to first perform PCA, project the data on the leading principal components and then perform <span class="math inline">\(k\)</span>-means clustering on the projected data</p>
<p>Clustering tasks may be motivated along different directions:</p>
<ul>
<li><p>The search for an interpretation of groups</p></li>
<li><p>Use of groups in further processing (prediction, …)</p></li>
</ul>
<aside class="notes"><p>This is especially true as many clustering approaches suffer from the curse of dimensionality</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="good-clustering" class="slide level2 center"><h2>Good clustering</h2>
<p>We need to define the <strong>quality of a cluster</strong> <i class="fa-solid fa-medal" aria-label="medal"></i></p>
<p>Unfortunately, no obvious quality measure exists! <i class="fa-solid fa-frown" aria-label="frown"></i></p>
<p>Clustering quality may be assessed by scrutinizing</p>
<ul>
<li><p><em>Inner homogeneity</em>: samples in the same group should be similar</p></li>
<li><p><em>Outer inhomogeneity</em>: samples in two different groups should be different.</p></li>
</ul></section><section id="shades-of-similarity" class="slide level2 center"><h2>Shades of similarity</h2>
<p>There are many possible definitions of <em>similar</em> and <em>different</em></p>
<p>Often, they are based on the distance between the samples</p>
<p>Examples based on the (squared) Euclidean distance:</p>
<ul>
<li><p>Inner homogeneity <span class="math inline">\(\approx\)</span> intra class variance/inertia,</p></li>
<li><p>Outer inhomogeneity <span class="math inline">\(\approx\)</span> inter class variance/inertia.</p></li>
</ul>
<p>Remember that, in flat clustering, the choice of the number <span class="math inline">\(K\)</span> of clusters is often delicate</p>
</section></section><section><section id="kleinbergs-theorem" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Kleinberg’s theorem</h1>

</section><section id="section-1" class="slide level2 center"><h2><i class="fa-solid fa-exclamation-triangle" aria-label="exclamation-triangle"></i></h2>
<ul>
<li><p>Clustering is not a single method</p></li>
<li><p>Clustering methods address a large range of problems.</p></li>
</ul>
<aside class="notes"><p>Turning this informal statement into a formal definition proves challenging.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="definition-clustering-function" class="slide level2 center"><h2>Definition Clustering function</h2>
<p>Define a <em>clustering function</em> <span class="math inline">\(F\)</span> as a function that</p>
<ul>
<li>takes as input any finite domain <span class="math inline">\(\mathcal{X}\)</span> with a dissimilarity function <span class="math inline">\(d\)</span> over its pairs</li>
</ul>
<p>and</p>
<ul>
<li>returns a partition of <span class="math inline">\(\mathcal{X}\)</span>
</li>
</ul></section><section id="desirable-properties" class="slide level2 center scrollable"><h2>Desirable properties</h2>
<p>A clustering function should ideally satisfy the next three properties</p>
<ol type="1">
<li><p><em>Scale Invariance</em>. For any domain set <span class="math inline">\(\mathcal{X}\)</span>, dissimilarity function <span class="math inline">\(d\)</span>, and any <span class="math inline">\(\alpha&gt;0\)</span>, the following should hold: <span class="math inline">\(F(\mathcal{X},d) = F(\mathcal{X},\alpha d)\)</span>.</p></li>
<li><p><em>Richness</em> For any finite <span class="math inline">\(\mathcal{X}\)</span> and every partition <span class="math inline">\(C = (C_1,\ldots,C_k)\)</span> of <span class="math inline">\(\mathcal{X}\)</span> (into nonempty subsets) there exists some dissimilarity function <span class="math inline">\(d\)</span> over <span class="math inline">\(\mathcal{X}\)</span> such that <span class="math inline">\(F(\mathcal{X},d)=C\)</span>.</p></li>
<li>
<p><em>Consistency</em> If <span class="math inline">\(d\)</span> and <span class="math inline">\(d'\)</span> are dissimilarity functions over <span class="math inline">\(\mathcal{X}\)</span>, such that for all <span class="math inline">\(x, y \in \mathcal{X}\)</span>,</p>
<ul>
<li>if <span class="math inline">\(x,y\)</span> belong to the same cluster in <span class="math inline">\(F(\mathcal{X},d)\)</span> then <span class="math inline">\(d'(x,y) \leq d(x,y)\)</span>,</li>
<li>if <span class="math inline">\(x,y\)</span> belong to different clusters in <span class="math inline">\(F(\mathcal{X},d)\)</span> then <span class="math inline">\(d'(x,y) \geq d(x,y)\)</span>,</li>
</ul>
</li>
</ol>
<p>then <span class="math inline">\(F(\mathcal{X},d) = F(\mathcal{X},d')\)</span>.</p>
<p><i class="fa-solid fa-smile" aria-label="smile"></i> Designing clustering functions meeting simultaneously <em>any two</em> of the <em>three</em> properties is doable</p>
<p>but</p>
<p><i class="fa-solid fa-frown" aria-label="frown"></i> The three reasonable goals are <em>conflicting</em></p>
</section><section id="kleinbergs-impossibility-theorem" class="slide level2 center"><h2>Kleinberg’s impossibility theorem</h2>
<div title="Theorem">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Theorem</strong></p>
</div>
<div class="callout-content">
<p><strong>No</strong> clustering function <span class="math inline">\(F\)</span> satisfies simultaneously all three properties:</p>
<ul>
<li><p><em>Scale Invariance</em>,</p></li>
<li><p><em>Richness</em>, and</p></li>
<li><p><em>Consistency</em></p></li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section><section id="flavors-of-clustering" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Flavors of clustering</h1>

</section><section id="flathierarchical-and" class="slide level2 center"><h2>Flat/Hierarchical and …</h2>
<p>A wide variety of clustering methods have been used in Statistics and Machine Learning.</p>
<ul>
<li>
<strong>Flat clustering (for example <span class="math inline">\(k\)</span>-means)</strong> partitions sample into a fixed number of classes (usually denoted by <span class="math inline">\(k\)</span>). The partition is determined by some algorithm</li>
</ul>
<p>.f6[The ultimate objective is to optimize some cost function. Whether the objective is achieved or even approximately achieved using a reasonable amount of computational resources is not settled]</p>
<ul>
<li>
<strong>Model based clustering</strong> is based on a generative model: data are assumed to be sampled from a specific model (usually finite mixtures of Gaussians, the model may or may not be parametric)</li>
</ul>
<p>.f6[Clustering consists in fitting such a mixture model and then assigning sample points to mixture components]</p>
<ul>
<li>
<em>Hierarchical clustering</em> is the topic of next lesson</li>
</ul></section><section id="carte-du-tendre" class="slide level2 center"><h2>Carte du tendre</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>In Machine Learning, <span class="math inline">\(k\)</span>-means and hierarchical clustering belong to a range of tasks called <em>non-supervised learning</em></p>
<p>This contrasts with regression which belongs to the realm of <em>supervised learning</em></p>
</div><div class="column">
<p><embed data-src="https://themlbook.com/wiki/lib/exe/fetch.php?cache=&amp;media=ml_map.png"></p>
</div></div>
</section></section><section><section id="k-means" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>
<em>k</em>-means</h1>

</section><section id="section-2" class="slide level2 center"><h2></h2>
<p>The <span class="math inline">\(k\)</span>-means algorithm is an iterative method that constructs a sequence of Voronoï partitions</p>
<p>A Voronoï diagram draws the nearest neighbor regions around a set of points.</p>
</section><section id="definition-voronoï-partitions" class="slide level2 center"><h2>Definition: Voronoï partitions</h2>
<p>Assume:</p>
<ul>
<li>sample <span class="math inline">\(X_1, \ldots, X_n\)</span> from <span class="math inline">\(\mathbb{R}^p\)</span>
</li>
<li>
<span class="math inline">\(\mathbb{R}^p\)</span> is endowed with a metric <span class="math inline">\(d\)</span>, usually <span class="math inline">\(\ell_2\)</span>, sometimes a weighted <span class="math inline">\(\ell_2\)</span> distance or <span class="math inline">\(\ell_1\)</span>
</li>
</ul>
<p>Each cluster is defined by a <em>centroid</em></p>
<p>The collection of centroids is (sometimes) called the <em>codebook</em> <span class="math inline">\(\mathcal{C}=c_1, \ldots, c_k\)</span></p>
<p>Each centroid <span class="math inline">\(c_j\)</span> defines a class:</p>
<p><span class="math display">\[C_j = \bigg\{ X_i : d(X_i, c_j) = \min_{j' \leq k} d(X_i, c_{j'})\bigg\}\]</span></p>
<p>and more generally a <em>Voronoï cell</em> in <span class="math inline">\(\mathbb{R}^p\)</span></p>
<p><span class="math display">\[C_j = \bigg\{ x :  x \in \mathbb{R}^p, d(x, c_j) = \min_{j' \leq k} d(x, c_{j'})\bigg\}\]</span></p>
</section><section id="a-voronoï-tesselation" class="slide level2 center"><h2>A Voronoï tesselation</h2>
<div class="columns">
<div class="column" style="width:70%;">
<!-- end columns -->
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<h4 id="euclidean-distance-dimension-2">Euclidean distance, dimension 2</h4>
<p>A voronoi tesselation generated by <span class="math inline">\(100\)</span> points picked at random on the gred <span class="math inline">\(\{1,\ldots, 200\}^2\)</span></p>
<p>Note that cell boundaries are line segments</p>
<p>Note that centroids may lie close to boundaries</p>
<p>The position of the centroid of a Voronoi cell depends on the positions of the centroids of the neighboring cells</p>
</div></div>
<aside class="notes"><p>See <a href="https://ggforce.data-imaginist.com/reference/index.html"><code>ggforce</code></a></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="a-voronoi-partition-for-projected-iris-dataset" class="slide level2 center"><h2>A Voronoi partition for projected Iris dataset</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>The black points marked with a cross define three centroids.</p>
<p>The straight lines delimit the Voronoï cells defined by the three centroids.</p>
<p>The colored points come from the Iris dataset: each point is colored according to the the cell it belongs to.</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/irisvoronoi-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section><section id="adding-centroids" class="slide level2 center"><h2>Adding centroids</h2>

<img data-src="slides-kmeans_files/figure-revealjs/sugar-1.png" width="960" class="r-stretch"></section><section id="k-means-objective-function" class="slide level2 center"><h2>
<em>k</em>-means objective function</h2>
<p>The <span class="math inline">\(k\)</span>-means algorithm aims at building a <em>codebook</em> <span class="math inline">\(\mathcal{C}\)</span> that minimizes</p>
<p><span class="math inline">\(\mathcal{C} \mapsto \sum_{i=1}^n \min_{c \in \mathcal{C}}  \norm X_i - c \norm_2^2\)</span></p>
<p>over all codebooks with given cardinality</p>
<p>If <span class="math inline">\(c \in \mathcal{C}\)</span> is the closest centroid to <span class="math inline">\(X \in \mathbb{R}^p\)</span>,</p>
<p><span class="math display">\[\|c - X\|^2\]</span></p>
<p>is the <em>quantization/reconstruction error</em> suffered when using codebook <span class="math inline">\(\mathcal{C}\)</span> to approximate <span class="math inline">\(X\)</span></p>
<p><i class="fa-solid fa-exclamation-triangle" aria-label="exclamation-triangle"></i> If there are no restrictions on the dimension of the input space, on the number of centroids, or on sample size, computing an optimal codebook is a <span class="math inline">\(\text{NP}\)</span> -hard problem</p>
</section><section id="k--means-at-work" class="slide level2 center"><h2>
<span class="math inline">\(k\)</span> -means at work</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>We may figure out what an optimized Voronoï partition looks like on the Iris dataset</p>
<p><code>kmeans</code> with <span class="math inline">\(k=3\)</span> on the Iris dataset</p>
<p>Function <code>kmeans</code> is run with default arguments</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/iriskmeans3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We chose the <code>Sepal</code> plane for clustering and visualization</p>
<p>This is arbitrary. We could have chosen a <code>Petal</code> plane, a <code>Width</code> plane, or a plane defined by principal axes.</p>
</div></div>
</section><section id="a-k-means-clustering-is-completely-characterized-by-the-k-centroids" class="slide level2 center"><h2>A <span class="math inline">\(k\)</span>-means clustering is completely characterized by the <span class="math inline">\(k\)</span> centroids</h2>
<p>Once centroids are known, clusters can be recovered by searching the closest centroid for each sample point (that is by delimiting the Voronoï cells).</p>
<ul>
<li><p>How can we assess the <em>quality</em> of a <span class="math inline">\(k\)</span>-means clustering?</p></li>
<li><p>Can we compare the clusterings achieved by picking different values of <span class="math inline">\(k\)</span>?</p></li>
</ul>
<p>There is no obvious assessment criterion!</p>
</section><section id="section-3" class="slide level2 center"><h2></h2>
<p>The <em>quality</em> of a clustering can be appreciated according to a wide variety of performance indicators</p>
<ul>
<li>Distortion: this is the <span class="math inline">\(k\)</span>-means cost</li>
<li>Shape of clusters</li>
<li>Relevance of clusters</li>
<li>Stability: does clustering depend on few points?</li>
</ul></section><section id="caveat" class="slide level2 center"><h2>Caveat</h2>
<p>When visualizing <span class="math inline">\(k\)</span>-means clustering on <code>Iris</code> data, we are cheating. <i class="fa-solid fa-theater-masks" aria-label="theater-masks"></i></p>
<p>We have a gold standard classification delivered by botanists</p>
<p>The botanists classification can be challenged</p>
<p>We can compare classification originating from <em>phenotypes</em> (appearance) and classification based on <em>phylogeny</em> (comparing DNAs) <i class="fa-solid fa-dna" aria-label="dna"></i></p>
</section><section id="summarising-a-k-means-clustering" class="slide level2 center"><h2>Summarising a <span class="math inline">\(k\)</span>-means clustering</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>A clustering can be summarized and illustrated.</p>
<p>In <i class="fa-solid fa-r-project" aria-label="r-project"></i> A meaningful summary is provided by the generic function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, or a <code>tidy</code> summary is providede by <code>broom::tidy(...)</code></p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div id="mqqfkvxtkg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mqqfkvxtkg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mqqfkvxtkg thead, #mqqfkvxtkg tbody, #mqqfkvxtkg tfoot, #mqqfkvxtkg tr, #mqqfkvxtkg td, #mqqfkvxtkg th {
  border-style: none;
}

#mqqfkvxtkg p {
  margin: 0;
  padding: 0;
}

#mqqfkvxtkg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mqqfkvxtkg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mqqfkvxtkg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mqqfkvxtkg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mqqfkvxtkg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mqqfkvxtkg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mqqfkvxtkg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mqqfkvxtkg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mqqfkvxtkg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mqqfkvxtkg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mqqfkvxtkg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mqqfkvxtkg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mqqfkvxtkg .gt_spanner_row {
  border-bottom-style: hidden;
}

#mqqfkvxtkg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mqqfkvxtkg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mqqfkvxtkg .gt_from_md > :first-child {
  margin-top: 0;
}

#mqqfkvxtkg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mqqfkvxtkg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mqqfkvxtkg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mqqfkvxtkg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mqqfkvxtkg .gt_row_group_first td {
  border-top-width: 2px;
}

#mqqfkvxtkg .gt_row_group_first th {
  border-top-width: 2px;
}

#mqqfkvxtkg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqqfkvxtkg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mqqfkvxtkg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mqqfkvxtkg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mqqfkvxtkg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqqfkvxtkg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mqqfkvxtkg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mqqfkvxtkg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mqqfkvxtkg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mqqfkvxtkg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mqqfkvxtkg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqqfkvxtkg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mqqfkvxtkg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mqqfkvxtkg .gt_left {
  text-align: left;
}

#mqqfkvxtkg .gt_center {
  text-align: center;
}

#mqqfkvxtkg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mqqfkvxtkg .gt_font_normal {
  font-weight: normal;
}

#mqqfkvxtkg .gt_font_bold {
  font-weight: bold;
}

#mqqfkvxtkg .gt_font_italic {
  font-style: italic;
}

#mqqfkvxtkg .gt_super {
  font-size: 65%;
}

#mqqfkvxtkg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mqqfkvxtkg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mqqfkvxtkg .gt_indent_1 {
  text-indent: 5px;
}

#mqqfkvxtkg .gt_indent_2 {
  text-indent: 10px;
}

#mqqfkvxtkg .gt_indent_3 {
  text-indent: 15px;
}

#mqqfkvxtkg .gt_indent_4 {
  text-indent: 20px;
}

#mqqfkvxtkg .gt_indent_5 {
  text-indent: 25px;
}

#mqqfkvxtkg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mqqfkvxtkg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="Sepal.Length" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Length</th>
<th id="Sepal.Width" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Width</th>
<th id="size" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">size</th>
<th id="withinss" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">withinss</th>
<th id="cluster" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">cluster</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Sepal.Length">6.81</td>
<td class="gt_row gt_right" headers="Sepal.Width">3.07</td>
<td class="gt_row gt_right" headers="size">47.00</td>
<td class="gt_row gt_right" headers="withinss">12.62</td>
<td class="gt_row gt_center" headers="cluster">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Sepal.Length">5.01</td>
<td class="gt_row gt_right" headers="Sepal.Width">3.43</td>
<td class="gt_row gt_right" headers="size">50.00</td>
<td class="gt_row gt_right" headers="withinss">13.13</td>
<td class="gt_row gt_center" headers="cluster">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Sepal.Length">5.77</td>
<td class="gt_row gt_right" headers="Sepal.Width">2.69</td>
<td class="gt_row gt_right" headers="size">53.00</td>
<td class="gt_row gt_right" headers="withinss">11.30</td>
<td class="gt_row gt_center" headers="cluster">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The concise summary tells us the number of points that are assigned to each cluster, and the Within Sum of Squares (WNSS). It says something about inner homogeneity and (apparently) nothing about outer homogeneity</p>
</div></div>
</section><section id="k-means-with-k2" class="slide level2 center"><h2>
<span class="math inline">\(k\)</span>-means with <span class="math inline">\(k=2\)</span>
</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>We pursue the exploration of <code>kmeans</code> by building another clustering for Iris dataset.</p>
<p>This times with <span class="math inline">\(k=2\)</span>.</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/iriskmeans2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="gyttypxtad" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gyttypxtad table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gyttypxtad thead, #gyttypxtad tbody, #gyttypxtad tfoot, #gyttypxtad tr, #gyttypxtad td, #gyttypxtad th {
  border-style: none;
}

#gyttypxtad p {
  margin: 0;
  padding: 0;
}

#gyttypxtad .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gyttypxtad .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gyttypxtad .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gyttypxtad .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gyttypxtad .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyttypxtad .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyttypxtad .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gyttypxtad .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gyttypxtad .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gyttypxtad .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gyttypxtad .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gyttypxtad .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gyttypxtad .gt_spanner_row {
  border-bottom-style: hidden;
}

#gyttypxtad .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gyttypxtad .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gyttypxtad .gt_from_md > :first-child {
  margin-top: 0;
}

#gyttypxtad .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gyttypxtad .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gyttypxtad .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gyttypxtad .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gyttypxtad .gt_row_group_first td {
  border-top-width: 2px;
}

#gyttypxtad .gt_row_group_first th {
  border-top-width: 2px;
}

#gyttypxtad .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyttypxtad .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gyttypxtad .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gyttypxtad .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyttypxtad .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyttypxtad .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gyttypxtad .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gyttypxtad .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gyttypxtad .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gyttypxtad .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyttypxtad .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyttypxtad .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gyttypxtad .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gyttypxtad .gt_left {
  text-align: left;
}

#gyttypxtad .gt_center {
  text-align: center;
}

#gyttypxtad .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gyttypxtad .gt_font_normal {
  font-weight: normal;
}

#gyttypxtad .gt_font_bold {
  font-weight: bold;
}

#gyttypxtad .gt_font_italic {
  font-style: italic;
}

#gyttypxtad .gt_super {
  font-size: 65%;
}

#gyttypxtad .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gyttypxtad .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gyttypxtad .gt_indent_1 {
  text-indent: 5px;
}

#gyttypxtad .gt_indent_2 {
  text-indent: 10px;
}

#gyttypxtad .gt_indent_3 {
  text-indent: 15px;
}

#gyttypxtad .gt_indent_4 {
  text-indent: 20px;
}

#gyttypxtad .gt_indent_5 {
  text-indent: 25px;
}

#gyttypxtad .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gyttypxtad div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="Sepal.Length" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Length</th>
<th id="Sepal.Width" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Width</th>
<th id="size" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">size</th>
<th id="withinss" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">withinss</th>
<th id="cluster" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">cluster</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Sepal.Length">5.22</td>
<td class="gt_row gt_right" headers="Sepal.Width">3.13</td>
<td class="gt_row gt_right" headers="size">83.00</td>
<td class="gt_row gt_right" headers="withinss">35.09</td>
<td class="gt_row gt_center" headers="cluster">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Sepal.Length">6.61</td>
<td class="gt_row gt_right" headers="Sepal.Width">2.97</td>
<td class="gt_row gt_right" headers="size">67.00</td>
<td class="gt_row gt_right" headers="withinss">23.11</td>
<td class="gt_row gt_center" headers="cluster">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></div>
</section><section id="how-should-we-pick-k" class="slide level2 center"><h2>
<i class="fa-solid fa-question" aria-label="question"></i> How should we pick <span class="math inline">\(k\)</span>?</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>Even if we could compute a provably optimal codebook for each <span class="math inline">\(k\)</span>, choosing <span class="math inline">\(k\)</span> would not be obvious</p>
<p>A common recipe consists of plotting within clusters sum of squares (<code>WNSS</code>) against <span class="math inline">\(k\)</span></p>
<p>Within clusters sum of squares (WNSS) decreases sharply between <span class="math inline">\(k=2\)</span> and <span class="math inline">\(k=3\)</span></p>
<p>For larger values of <span class="math inline">\(k\)</span>, the decay is much smaller.</p>
<p>The <em>elbow</em> rule of thumb suggests to choose <span class="math inline">\(k=3\)</span>.</p>
</div><div class="column">
<p>We have run <code>kmeans</code> over the Iris dataset, for <span class="math inline">\(k\)</span> in range <span class="math inline">\(2, \ldots, 10\)</span>. For each value of <span class="math inline">\(k\)</span>, we performed <span class="math inline">\(32\)</span> randomized initializations, and chose the partition that minimizes within clusters sum of squares</p>
</div></div>
</section><section id="incentive-to-choose-k4" class="slide level2 center"><h2>Incentive to choose <span class="math inline">\(k=4\)</span>?</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>Depending on initialization, taking <span class="math inline">\(k=4\)</span> creates a cluster at the boundary between <code>versicolor</code> and <code>virginica</code> or it may split the <code>setosa</code> cluster</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/iriskmeans4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="yhhkpsmaza" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yhhkpsmaza table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yhhkpsmaza thead, #yhhkpsmaza tbody, #yhhkpsmaza tfoot, #yhhkpsmaza tr, #yhhkpsmaza td, #yhhkpsmaza th {
  border-style: none;
}

#yhhkpsmaza p {
  margin: 0;
  padding: 0;
}

#yhhkpsmaza .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yhhkpsmaza .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yhhkpsmaza .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yhhkpsmaza .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yhhkpsmaza .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yhhkpsmaza .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yhhkpsmaza .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yhhkpsmaza .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yhhkpsmaza .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yhhkpsmaza .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yhhkpsmaza .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yhhkpsmaza .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yhhkpsmaza .gt_spanner_row {
  border-bottom-style: hidden;
}

#yhhkpsmaza .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yhhkpsmaza .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yhhkpsmaza .gt_from_md > :first-child {
  margin-top: 0;
}

#yhhkpsmaza .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yhhkpsmaza .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yhhkpsmaza .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yhhkpsmaza .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yhhkpsmaza .gt_row_group_first td {
  border-top-width: 2px;
}

#yhhkpsmaza .gt_row_group_first th {
  border-top-width: 2px;
}

#yhhkpsmaza .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yhhkpsmaza .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yhhkpsmaza .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yhhkpsmaza .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yhhkpsmaza .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yhhkpsmaza .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yhhkpsmaza .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yhhkpsmaza .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yhhkpsmaza .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yhhkpsmaza .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yhhkpsmaza .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yhhkpsmaza .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yhhkpsmaza .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yhhkpsmaza .gt_left {
  text-align: left;
}

#yhhkpsmaza .gt_center {
  text-align: center;
}

#yhhkpsmaza .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yhhkpsmaza .gt_font_normal {
  font-weight: normal;
}

#yhhkpsmaza .gt_font_bold {
  font-weight: bold;
}

#yhhkpsmaza .gt_font_italic {
  font-style: italic;
}

#yhhkpsmaza .gt_super {
  font-size: 65%;
}

#yhhkpsmaza .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yhhkpsmaza .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yhhkpsmaza .gt_indent_1 {
  text-indent: 5px;
}

#yhhkpsmaza .gt_indent_2 {
  text-indent: 10px;
}

#yhhkpsmaza .gt_indent_3 {
  text-indent: 15px;
}

#yhhkpsmaza .gt_indent_4 {
  text-indent: 20px;
}

#yhhkpsmaza .gt_indent_5 {
  text-indent: 25px;
}

#yhhkpsmaza .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yhhkpsmaza div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="Sepal.Length" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Length</th>
<th id="Sepal.Width" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sepal.Width</th>
<th id="size" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">size</th>
<th id="withinss" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">withinss</th>
<th id="cluster" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">cluster</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Sepal.Length">5.518182</td>
<td class="gt_row gt_right" headers="Sepal.Width">2.606061</td>
<td class="gt_row gt_right" headers="size">33</td>
<td class="gt_row gt_right" headers="withinss">5.967879</td>
<td class="gt_row gt_center" headers="cluster">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Sepal.Length">5.016327</td>
<td class="gt_row gt_right" headers="Sepal.Width">3.451020</td>
<td class="gt_row gt_right" headers="size">49</td>
<td class="gt_row gt_right" headers="withinss">11.569388</td>
<td class="gt_row gt_center" headers="cluster">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Sepal.Length">7.283333</td>
<td class="gt_row gt_right" headers="Sepal.Width">3.133333</td>
<td class="gt_row gt_right" headers="size">18</td>
<td class="gt_row gt_right" headers="withinss">3.905000</td>
<td class="gt_row gt_center" headers="cluster">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Sepal.Length">6.350000</td>
<td class="gt_row gt_right" headers="Sepal.Width">2.942000</td>
<td class="gt_row gt_right" headers="size">50</td>
<td class="gt_row gt_right" headers="withinss">6.786800</td>
<td class="gt_row gt_center" headers="cluster">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></div>
</section><section id="initialization-matters" class="slide level2 center"><h2>Initialization matters!</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li><p>Initialize by samples.</p></li>
<li><p><code>k-Mean++</code> try to take them as separated as possible.</p></li>
<li><p>No guarantee to converge to a global optimum!</p></li>
<li><p>Trial and error.</p></li>
<li><p>Repeat and keep the best result.</p></li>
</ul>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">kmeans</span>(x,       <span class="co"># data</span></span>
<span id="cb1-2"><a></a>       centers, <span class="co"># initial centroids or number of clusters</span></span>
<span id="cb1-3"><a></a>       <span class="at">iter.max =</span> <span class="dv">10</span>,</span>
<span id="cb1-4"><a></a>       <span class="at">nstart =</span> <span class="dv">1</span>,  <span class="co"># number of trials</span></span>
<span id="cb1-5"><a></a>       <span class="at">algorithm =</span> <span class="fu">c</span>(<span class="st">"Hartigan-Wong"</span>, <span class="co"># default</span></span>
<span id="cb1-6"><a></a>                     <span class="st">"Lloyd"</span>,         <span class="co">#&lt;&lt; old one</span></span>
<span id="cb1-7"><a></a>                     <span class="st">"Forgy"</span>,</span>
<span id="cb1-8"><a></a>                     <span class="st">"MacQueen"</span>),</span>
<span id="cb1-9"><a></a>       <span class="at">trace=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section></section><section><section id="lloyds-algorithm" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Lloyd’s Algorithm</h1>

</section><section id="lloyds-algorithm-detailed-for-fixed-k-naive-k-means" class="slide level2 center scrollable"><h2>Lloyd’s Algorithm (detailed) for fixed <em>k</em> (naive <em>k</em>-means)</h2>
<ol type="1">
<li><p>Initialize Choose <span class="math inline">\(k\)</span> centroids</p></li>
<li><p>Iterations: Two phases</p></li>
<li><p>(Movement) Assign each sample point to the closest <em>centroid</em> Assign each sample point to a class in the Voronoi partition defined by the centroids</p></li>
<li><p>(Update) For each class in the current Voronoi partition, update the <em>centroid</em> so as to minimize the Within Cluster Sum of Squared distances.</p></li>
</ol></section><section id="lloyds-iterations" class="slide level2 center"><h2>Lloyd’s iterations</h2>
</section><section id="after-1-step" class="slide level2 center"><h2>After 1 step</h2>

<img data-src="slides-kmeans_files/figure-revealjs/lloyd1-1.png" width="960" class="r-stretch"></section><section id="lloyds-iterations-after-2-steps" class="slide level2 center"><h2>Lloyd’s iterations after 2 steps</h2>

<img data-src="slides-kmeans_files/figure-revealjs/lloyd5-1.png" width="960" class="r-stretch"></section><section id="lloyds-iterations-after-4-steps" class="slide level2 center"><h2>Lloyd’s iterations after 4 steps</h2>

<img data-src="slides-kmeans_files/figure-revealjs/lloyd00-1.png" width="960" class="r-stretch"></section></section><section><section id="lloyds-algorithm-analysis" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Lloyd’s algorithm (analysis)</h1>

</section><section id="analysis" class="slide level2 center"><h2>Analysis</h2>
<p>Given</p>
<ul>
<li>codebook <span class="math inline">\(\mathcal{C} =\big\{c_1, \ldots, c_k\big\}\)</span> and</li>
<li>clusters <span class="math inline">\(C_1, \ldots C_k\)</span>,</li>
</ul>
<p>the <em>within-clusters sum of squares</em> is defined as</p>
<p><span class="math inline">\(\sum_{j=1}^k  \sum_{i: X_i \in C_j} \bigg\Vert c_j - X_i \bigg\Vert^2\)</span></p>
<p><i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i> This is also the kmeans cost</p>
</section><section id="section-4" class="slide level2 center"><h2></h2>
<div title="Lemma">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Lemma</strong></p>
</div>
<div class="callout-content">
<p>At each stage, the <em>within clusters sums of squares</em> does not increase</p>
</div>
</div>
</div>
</div>
</section><section id="proof" class="slide level2 center"><h2>Proof</h2>
<p>Let <span class="math inline">\(\mathcal{C}^{(t)} =\big\{ c^{(t)}_1, \ldots, c_k^{(t)}\big\}\)</span> be the codebook after <span class="math inline">\(t\)</span> steps</p>
<p>Let <span class="math inline">\(\big({C}^{(t)}_j\big)_{j \leq k}\)</span> be the clusters after <span class="math inline">\(t\)</span> steps</p>
<ul>
<li>Centroids at step <span class="math inline">\(t+1\)</span> are the barycenters of clusters <span class="math inline">\(\big({C}^{(t)}_j\big)_{j \leq k}\)</span>
</li>
</ul>
<p><span class="math inline">\(c^{(t+1)}_j = \frac{1}{|C_j^{(t)}|} \sum_{X_i \in C^{(t)}_j} X_i\)</span></p>
<ul>
<li>Clusters <span class="math inline">\(C^{(t+1)}_j\)</span> are defined by</li>
</ul>
<p><span class="math inline">\(C^{(t+1)}_j = \bigg\{ X_i : \Vert X_i -  c^{(t+1)}_j\Vert = \min_{c \in \mathcal{C}^{(t+1)}} \Vert X_i -  c\Vert \bigg\}\)</span></p>
<p>Each sample point is assigned to the closest centroid</p>
</section><section id="proof-continued" class="slide level2 center"><h2>Proof (continued)</h2>
<p><span class="math display">\[\sum_{j=1}^k \sum_{X_i \in C^{(t)}_j} \bigg\Vert c^{(t)}_j  - X_i\bigg\Vert^2  \geq \sum_{j=1}^k \sum_{X_i \in C^{(t)}_j} \bigg\Vert c^{(t+1)}_j  - X_i\bigg\Vert^2\]</span></p>
<p>since for each <span class="math inline">\(j\)</span>, the mean <span class="math inline">\(c^{(t+1)}_j\)</span> minimizes the average square distance to points in <span class="math inline">\(C^{(t)}_j\)</span></p>
<p><span class="math display">\[\sum_{j=1}^k \sum_{X_i \in C^{(t)}_j} \bigg\Vert c^{(t+1)}_j  - X_i\bigg\Vert^2 \geq \sum_{j=1}^k \sum_{X_i \in C^{(t)}_j} \min_{c \in \mathcal{C}^{(t+1)}}\bigg\Vert c  - X_i\bigg\Vert^2\]</span></p>
<p><span class="math display">\[\sum_{j=1}^k \sum_{X_i \in C^{(t)}_j} \min_{c \in \mathcal{C}^{(t+1)}}\bigg\Vert c  - X_i\bigg\Vert^2 = \sum_{j=1}^k \sum_{X_i \in C^{(t+1)}_j} \bigg\Vert c^{(t+1)}_j  - X_i\bigg\Vert^2\]</span></p>
<p><i class="fa-solid fa-square" aria-label="square"></i></p>
</section><section id="variants-of-k-means" class="slide level2 center"><h2>
<i class="fa-solid fa-code-branch" aria-label="code-branch"></i> Variants of <em>k</em>-means</h2>
<p>Implementations of <span class="math inline">\(k\)</span>-means vary with respect to</p>
<ul>
<li>Initialization
<ul>
<li><code>k-means++</code></li>
<li>Forgy : pick initial centroids at random from the dataset</li>
<li>Random partition : pick a random partition of the dataset and initialize centroids by computing means in each class</li>
<li>…</li>
</ul>
</li>
<li>Movement/assignment
<ul>
<li>Naive <span class="math inline">\(k\)</span> means uses brute-force search for closest centroid. Each step requires <span class="math inline">\(\Omega(n \times k)\)</span> operations</li>
<li>Elkan (used by <i class="fa-solid fa-python" aria-label="python"></i> <code>scikit-learn</code>)</li>
<li>Hartigan-Wong <i class="fa-solid fa-r-project" aria-label="r-project"></i> default</li>
<li>…</li>
</ul>
</li>
</ul>
<aside class="notes"><blockquote>
<p>Lloyd’s algorithm is the standard approach for this problem. However, it spends a lot of processing time computing the distances between each of the k cluster centers and the n data points. Since points usually stay in the same clusters after a few iterations, much of this work is unnecessary, making the naïve implementation very inefficient. Some implementations use caching and the triangle inequality in order to create bounds and accelerate Lloyd’s algorithm. .fr.f6[Wikipedia]</p>
</blockquote>
<p>In base <i class="fa-solid fa-r-project" aria-label="r-project"></i>, <code>kmeans</code> is a wrapper for different but related algorithms.</p>
<p>Lloyd’s algorithm is the first and simplest versions of a series of heuristic methods designed to minimize the k-means cost</p>
<ul>
<li><p><code>MacQueen</code> modify the mean each time a sample is assigned to a new cluster</p></li>
<li><p><code>Hartigan-Wong</code> is the <em>default</em> method. It modifies the mean by removing the considered sample point, assign it to the nearby center and recompute the new mean after assignment.</p></li>
<li><p><code>Forgy</code></p></li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section></section><section><section id="combining-pca-and-k-means" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Combining PCA and <span class="math inline">\(k\)</span>-means</h1>

</section><section id="section-5" class="slide level2 center"><h2><i class="fa-solid fa-binoculars" aria-label="binoculars"></i></h2>
<p>The result of a clustering procedure like <code>kmeans</code> can be visualized by projecting the dataset on a pair of native variables and using some aesthetics to emphasize the clusters</p>
<p>This is not always the best way.</p>
<p>First choosing a pair of native variables may not be straightforward. The projected pairwise distances may not faithfully reflect the pairwise distances that serve for clustering.</p>
<p>It makes sense to project the dataset of the <span class="math inline">\(2\)</span>-dimensional subspace that maximizes the projected inertia, that is on the space generated by the first two principal components</p>
</section><section id="pca-projection-k-means" class="slide level2 center"><h2>PCA, projection, <span class="math inline">\(k\)</span>-means</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>The kmeans clustering of the Iris dataset is projected on the first two principal components: <code>prcomp</code> is used to perform PCA with neither centering nor scaling</p>
<p><code>kmeans</code> is applied to the rotated data</p>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="slides-kmeans_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p><i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i> The straight lines are the not the projections of the boundaries of the (4-dimensional) Voronoï cells defined by the clusters centroids, but the boundaries of the 2-dimensional Voronoï celles defined by the projections of the cluster centroids</p>
</div></div>
</section><section id="questions-around-k-means" class="slide level2 center"><h2>
<i class="fa-solid fa-question" aria-label="question"></i> Questions around <em>k</em>-means</h2>
<ul>
<li><p>Choosing <span class="math inline">\(k\)</span></p></li>
<li><p>Assessing clustering quality</p></li>
<li><p>Scaling or not scaling ?</p></li>
<li><p>Choosing a distance</p></li>
<li><p>Initialization methods</p></li>
<li><p>Movement/assignment update</p></li>
<li><p>Stopping rules</p></li>
</ul></section><section id="conclusion" class="slide level2 center"><h2>
<i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Conclusion</h2>
<ul>
<li><p>Euclidean distance is used as a metric and inertia is used as a measure of cluster scatter</p></li>
<li><p>The number of clusters <span class="math inline">\(k\)</span> is an input parameter</p></li>
<li><p>Convergence to a local minimum may produce counterintuitive (“wrong”) results</p></li>
</ul></section></section><section id="the-end" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>The End</h1>


<div class="reveal-header">
<div class="header-logo" data-header-logo-link="https://u-paris.fr">
<img data-src="../../images/logo.png">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p>Clustering and k-means</p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
</section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../images/UniversiteParis_monogramme_couleur_RVB.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="http://s-v-b.github.io/MA7BY020">MA7BY020</a> – Analyse de Données – M1 MIDS – UParis Cité</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/s-v-b\.github\.io\/MA7BY020\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
              // default icon
              link.classList.add("external");
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script><script type="text/javascript">
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let pseudocodeOptions = {
              indentSize: el.dataset.indentSize || "1.2em",
              commentDelimiter: el.dataset.commentDelimiter || "//",
              lineNumber: el.dataset.lineNumber === "true" ? true : false,
              lineNumberPunc: el.dataset.lineNumberPunc || ":",
              noEnd: el.dataset.noEnd === "true" ? true : false,
              titlePrefix: el.dataset.captionPrefix || "Algorithm"
            };
            pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
          });
        })(document);
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
            if (captionSpan !== null) {
              let captionPrefix = el.dataset.captionPrefix + " ";
              let captionNumber = "";
              if (el.dataset.pseudocodeNumber) {
                captionNumber = el.dataset.pseudocodeNumber + " ";
                if (el.dataset.chapterLevel) {
                  captionNumber = el.dataset.chapterLevel + "." + captionNumber;
                }
              }
              captionSpan.innerHTML = captionPrefix + captionNumber;
            }
          });
        })(document);
        </script>


</body></html>