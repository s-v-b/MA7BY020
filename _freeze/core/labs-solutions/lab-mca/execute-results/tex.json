{
  "hash": "49aaf624c84f599f54ecf88777b61137",
  "result": {
    "engine": "knitr",
    "markdown": "---\ndate: \"2025-03-25 22:52:06.033729\"\ntitle: \"LAB: Multiple Correspondence Analysis (MCA)\"\n\n\nexecute:\n  echo: true\n  eval: true\n  collapse: true\n\nformat:\n  html:\n    output-file: lab-mca.html\n  pdf:\n    output-file: lab-mca.pdf\n\n\nengine: knitr\n---\n\n\n\n\n\n\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Année {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n\n\nBesides the usual packages (`tidyverse`, ...),  we shall require \n`FactoMineR` and related packages.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nstopifnot(\n  require(FactoMineR),\n  require(factoextra),\n  require(FactoInvestigate)\n)\n```\n:::\n\n\n\n\n\n\n\n\n\n## The `GSS`  dataset\n\nWe will use data coming from the General Social Survey. The General Social Survey data can be retrieved using the `gssr` package. If needed, install the `gssr` package and its companion package `gssrdoc`. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstopifnot(\n  require(\"gssr\"),\n  require(\"gssrdoc\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: gssr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPackage loaded. To attach the GSS data, type data(gss_all) at the console.\nFor the codebook, type data(gss_dict).\nFor the panel data and documentation, type e.g. data(gss_panel08_long) and data(gss_panel_doc).\nFor help on a specific GSS variable, type ?varname at the console.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: gssrdoc\n```\n\n\n:::\n:::\n\n\n\n\n\n\nThe data we will use are panel data made available by the GSS. In order to explore them, it's very useful  toload `gss_dict` and `gss_panel_doc`. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(gss_dict)\ndata(gss_panel_doc)\n```\n:::\n\n\n\n\n\n\nCheck the online help. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?gss_panel_doc\n```\n:::\n\n\n\n\n\n\n `gss_dict` and `gss_panel_doc` are dataframes that can be queried:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel_doc |> \n  dplyr::sample_n(5) |> \n  select(id, text)  |> \n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{ll}\n\\toprule\nid & text \\\\ \n\\midrule\\addlinespace[2.5pt]\nrelhh2 & 1632. What is (PERSON)'s relationship to head of household? \\\\ \ncolrac & 78. Or consider a person who believes that Blacks are                           genetically inferior. b. Should such a person be allowed to                     teach in a college or university, or not? \\\\ \nissp & 1661. Status on International Social Survey Program                             Self-Completion Supplement. \\\\ \nrellife & Please tell me whether you strongly agree, agree, disagree, or                  strongly disagree with the following statements: 679. I try hard                to carry my religious beliefs over into all my other dealings in                life. \\\\ \nrelate3 & 1621. Please tell me the names of the people who usually live in this household. Let's start with the head of the household. a.                  What is [PERSON]'s relationship to the head of household? \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\nIn the panel *questionnaire*, some questions have `race` in the field `id`.  Check again the online help. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?race\n```\n:::\n\n\n\n\n\n\nThe answer is something like that:\n\n```\nQuestion 24. What race do you consider yourself?\n```\n\nAnd it contains a brief summary of the answers given through the years.\n\n\n| Year | Black  | Other | White | iap (NA) | Total| \n|-----:|-------:|------:|------:|-------:|-------:|\n| 2010 |\t311   |\t183\t  | 1550  |\t     - |\t 2044 |\n| 2012 |  301\t  | 196\t  | 1477\t|      - |\t 1974 |\n| 2014 |\t386\t  | 262   |\t1890\t|      - |\t 2538 |\n\n(this is just an excerpt)\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel_doc |> \n  filter(str_detect(id, \"race\")) |>\n  slice_sample(n=1, by=text) |> \n  select(id, description, text) |> \n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{lll}\n\\toprule\nid & description & text \\\\ \n\\midrule\\addlinespace[2.5pt]\nrace & RACE & 24. What race do you consider yourself? \\\\ \nracecen1 & RACECEN1 & 1602. What is your race? Indicate one or more races that you                    consider yourself to be. \\\\ \nnatrace & NATRACE & 68. We are faced with many problems in this country, none of                    some of these problems, and for each one I'd like you to tell me                whether you think we're spending too much money on it, too                      little money, or about the right amount. h. Improving the                       conditions of Blacks. \\\\ \nnatracey & NATRACEY & 69. We are faced with many problems in this country, none of                    some of these problems, and for each one I'd like you to tell me                whether you think we're spending too much money on it, too                      little money, or about the right amount. h. Assistance to                       blacks. \\\\ \nintrace1 & INTRACE1 & What is your race? Indicate one or more races that you consider                 yourself to be. \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\nThe data set we will use comes from year 2010 panel data.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"gss_panel10_long\")\n\ngss_panel10_long \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6,132 x 1,200\n   firstid  wave oversamp sampcode  sample      form         formwt vpsu  vstrat\n   <fct>   <dbl>    <dbl> <dbl+lbl> <dbl+lbl>   <dbl+lbl>     <dbl> <dbl> <dbl+>\n 1 1           1        1 501       9 [2000 FP] 2 [ALTERNAT~      1 1     2240  \n 2 1           2        1 501       9 [2000 FP] 2 [ALTERNAT~      1 1     2240  \n 3 1           3        1 501       9 [2000 FP] 2 [ALTERNAT~      1 1     2240  \n 4 2           1        1 501       9 [2000 FP] 1 [STANDARD~      1 1     2240  \n 5 2           2        1 501       9 [2000 FP] 1 [STANDARD~      1 1     2240  \n 6 2           3        1 501       9 [2000 FP] 1 [STANDARD~      1 1     2240  \n 7 3           1        1 501       9 [2000 FP] 1 [STANDARD~      1 2     2240  \n 8 3           2        1 501       9 [2000 FP] 1 [STANDARD~      1 2     2240  \n 9 3           3        1 501       9 [2000 FP] 1 [STANDARD~      1 2     2240  \n10 4           1        1 501       9 [2000 FP] 2 [ALTERNAT~      1 2     2240  \n# i 6,122 more rows\n# i 1,191 more variables: samptype <dbl+lbl>, wtpan12 <dbl+lbl>,\n#   wtpan123 <dbl+lbl>, wtpannr12 <dbl+lbl>, wtpannr123 <dbl+lbl>,\n#   id <dbl+lbl>, mar1 <dbl+lbl>, mar2 <dbl+lbl>, mar3 <dbl+lbl>,\n#   mar4 <dbl+lbl>, mar5 <dbl+lbl>, mar6 <dbl+lbl>, mar7 <dbl+lbl>,\n#   mar8 <dbl+lbl>, mar9 <dbl+lbl>, mar10 <dbl>, mar11 <dbl+lbl>, mar12 <dbl>,\n#   mar13 <dbl>, mar14 <dbl>, abany <dbl+lbl>, abdefect <dbl+lbl>, ...\n```\n\n\n:::\n:::\n\n\n\n\n\n\nAt the beginning, the panel was made of roughly 2000 respondents. And the respondents were interviewed in 2010, 2012 and 2014 (the three waves). \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel10_long  |>  \n  filter(wave==3, !is.na(id)) |>\n  select(firstid, wave, id, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,304 x 4\n   firstid  wave id        sex       \n   <fct>   <dbl> <dbl+lbl> <dbl+lbl> \n 1 1           3 10001     1 [MALE]  \n 2 2           3 10002     2 [FEMALE]\n 3 3           3 10003     2 [FEMALE]\n 4 6           3 10004     1 [MALE]  \n 5 7           3 10005     2 [FEMALE]\n 6 9           3 10006     2 [FEMALE]\n 7 10          3 10007     2 [FEMALE]\n 8 11          3 10008     2 [FEMALE]\n 9 12          3 10009     1 [MALE]  \n10 13          3 10010     1 [MALE]  \n# i 1,294 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n\nSome respondents left the survey. Attrition can be monitored within the next query. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel10_long |> \n  select(wave, id) |>\n  group_by(wave) |>\n  summarize(observed = n_distinct(id),\n            missing = sum(is.na(id)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n   wave observed missing\n  <dbl>    <int>   <int>\n1     1     2044       0\n2     2     1552     493\n3     3     1305     740\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## The confidence topic\n\nDo GSS surveys are made of a huge number of questions. Not all questions were asked to the respondents. Indeed, each question was asked to two thirds of the respondents. Questions were related to demographic features (Age, Sex, Level of education, Employment and so on). Answers to these questions can be used to determine whether the panel sample is representative. Data can be compared with last census data (there is a census every ten years in the US). \n\nA number of questions are related to the *confidence* topic. Respondents were asked about the level of confidence they put  in a wide array of institutions. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel_doc |> \n  filter(str_detect(text, \"confidence\")) |>\n  slice_sample(n=1, by=text) |> \n  select(id, description, text) |> \n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{lll}\n\\toprule\nid & description & text \\\\ \n\\midrule\\addlinespace[2.5pt]\nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. \\\\ \nconbus & CONBUS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? b. Major                   companies. \\\\ \nconclerg & CONCLERG & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? c.                         Organized religion. \\\\ \nconeduc & CONEDUC & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? d.                         Education. \\\\ \nconfed & CONFED & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? e.                         Executive branch of the federal government. \\\\ \nconlabor & CONLABOR & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? f.                         Organized labor. \\\\ \nconpress & CONPRESS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? g. Press. \\\\ \nconmedic & CONMEDIC & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? h.                         Medicine. \\\\ \ncontv & CONTV & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? i.                         Television. \\\\ \nconjudge & CONJUDGE & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? j. U.S.                    Supreme Court. \\\\ \nconsci & CONSCI & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? k.                         Scientific community. \\\\ \nconlegis & CONLEGIS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? l. Congress \\\\ \nconarmy & CONARMY & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? m. Military \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\nFor institutions like *Science* or *Medicine*, or *Executive branch of federal government*, Respondents were asked whether they have: *Great deal of confidence*, *Only some confidence*, *Hardly any confidence* in the institution. \nThe same Likert scale with 3 levels was used for all institutions. \n\n::: {.callout-note}\n\n### Question\n\nFrom the `gss_panel10_long` dataset, extract columns corresponding to questions from the *confidence topic*\n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n\n::: {.callout-tip title='Solution'} \n \nWe first gather the `id` of the questions pertaining to the confidence topic.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_ids <- gss_panel_doc |> \n  filter(str_detect(text, \"confidence\")) |>\n  slice_sample(n=1, by=text) |> \n  pull(id)\n```\n:::\n\n\n\n\n\n\nThen we protect the panel data on the questions pertaining to the confidence topic. We also keep the respondent key, sex, and the relevant wave. \ns\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel10_long |> \n  filter(wave==1) |>\n  select(firstid, wave, id, sex, contains(confidence_ids)) |>\n  sample_n(10) |>\n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{crcccccccccccccrcc}\n\\toprule\nfirstid & wave & id\\_1: id & sex\\_1: RESPONDENTS SEX & confinan\\_1: CONFID IN BANKS \\& FINANCIAL INSTITUTIONS & conbus\\_1: CONFIDENCE IN MAJOR COMPANIES & conclerg\\_1: CONFIDENCE IN ORGANIZED RELIGION & coneduc\\_1: CONFIDENCE IN EDUCATION & confed\\_1: CONFID. IN EXEC BRANCH OF FED GOVT & conlabor\\_1: CONFIDENCE IN ORGANIZED LABOR & conpress\\_1: CONFIDENCE IN PRESS & conmedic\\_1: CONFIDENCE IN MEDICINE & contv\\_1: CONFIDENCE IN TELEVISION & conjudge\\_1: CONFID. IN UNITED STATES SUPREME COURT & consci\\_1: CONFIDENCE IN SCIENTIFIC COMMUNITY & econsci & conlegis\\_1: CONFIDENCE IN CONGRESS & conarmy\\_1: CONFIDENCE IN MILITARY \\\\ \n\\midrule\\addlinespace[2.5pt]\n286 & 1 & 286 & 1 & 3 & 3 & 3 & 3 & 3 & 2 & 3 & 3 & 2 & 3 & 2 & NA & 3 & 2 \\\\ \n271 & 1 & 271 & 2 & 2 & 2 & 3 & 2 & 3 & 3 & 2 & 3 & 2 & 2 & 2 & NA & 3 & 3 \\\\ \n647 & 1 & 647 & 1 & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA \\\\ \n1471 & 1 & 1471 & 2 & 2 & 2 & 1 & 1 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & NA & 1 & 1 \\\\ \n1739 & 1 & 1739 & 1 & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA \\\\ \n2016 & 1 & 2016 & 1 & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA \\\\ \n1618 & 1 & 1618 & 2 & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA & NA \\\\ \n1849 & 1 & 1849 & 1 & 3 & 2 & 2 & 2 & 2 & 3 & 2 & 2 & 3 & 2 & 3 & NA & 2 & 2 \\\\ \n1715 & 1 & 1715 & 2 & 2 & 2 & NA & 2 & 3 & 2 & 2 & 2 & 3 & 2 & 2 & NA & 2 & 2 \\\\ \n628 & 1 & 628 & 2 & 3 & 3 & 3 & 3 & 3 & 2 & 3 & 2 & 3 & 2 & 1 & NA & 3 & 3 \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\nLet us go back to the documentation. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngss_panel_doc |>\n  filter(id %in% confidence_ids) |> \n  select(-ends_with(\"2\"), -ends_with(\"3\")) |>\n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{lllcc}\n\\toprule\nid & description & text & properties\\_1 & marginals\\_1 \\\\ \n\\midrule\\addlinespace[2.5pt]\nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/265\"), c(\"CONFINAN\\_1\", \"CONFINAN\\_1\", \"CONFINAN\\_1\") & c(30.1, 55.2, 14.7, NA, NA, 100), c(\"395\", \"725\", \"193\", \"671\", \"16\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", \"Total\"), c(\"CONFINAN\\_1\", \"CONFINAN\\_1\", \"CONFINAN\\_1\", \"CONFINAN\\_1\", \"CONFINAN\\_1\", \"CONFINAN\\_1\") \\\\ \nconbus & CONBUS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? b. Major                   companies. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/247\"), c(\"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\") & c(17.6, 62.3, 20.1, NA, NA, NA, 100), c(\"228\", \"806\", \"260\", \"671\", \"32\", \"3\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\", \"CONBUS\\_1\") \\\\ \nconclerg & CONCLERG & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? c.                         Organized religion. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/250\"), c(\"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\") & c(25.1, 52.5, 22.4, NA, NA, NA, 100), c(\"324\", \"678\", \"289\", \"671\", \"35\", \"3\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\", \"CONCLERG\\_1\") \\\\ \nconeduc & CONEDUC & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? d.                         Education. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/259\"), c(\"CONEDUC\\_1\", \"CONEDUC\\_1\", \"CONEDUC\\_1\") & c(27.1, 56.5, 16.4, NA, NA, 100), c(\"359\", \"747\", \"217\", \"671\", \"6\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", \"Total\"), c(\"CONEDUC\\_1\", \"CONEDUC\\_1\", \"CONEDUC\\_1\", \"CONEDUC\\_1\", \"CONEDUC\\_1\", \"CONEDUC\\_1\") \\\\ \nconfed & CONFED & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? e.                         Executive branch of the federal government. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/262\"), c(\"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\") & c(13.8, 45.4, 40.8, NA, NA, NA, 100), c(\"179\", \"590\", \"531\", \"671\", \"26\", \"3\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\", \"CONFED\\_1\") \\\\ \nconlabor & CONLABOR & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? f.                         Organized labor. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/289\"), c(\"CONLABOR\\_1\", \"CONLABOR\\_1\", \"CONLABOR\\_1\") & c(12.3, 58.1, 29.6, NA, NA, 100), c(\"155\", \"731\", \"372\", \"671\", \"71\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", \"Total\"), c(\"CONLABOR\\_1\", \"CONLABOR\\_1\", \"CONLABOR\\_1\", \"CONLABOR\\_1\", \"CONLABOR\\_1\", \"CONLABOR\\_1\") \\\\ \nconpress & CONPRESS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? g. Press. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/298\"), c(\"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\") & c(10, 48.5, 41.5, NA, NA, NA, 100), c(\"132\", \"638\", \"546\", \"671\", \"12\", \"1\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\", \"CONPRESS\\_1\") \\\\ \nconmedic & CONMEDIC & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? h.                         Medicine. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/295\"), c(\"CONMEDIC\\_1\", \"CONMEDIC\\_1\", \"CONMEDIC\\_1\") & c(40.1, 49.3, 10.6, NA, NA, 100), c(\"530\", \"651\", \"140\", \"671\", \"8\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", \"Total\"), c(\"CONMEDIC\\_1\", \"CONMEDIC\\_1\", \"CONMEDIC\\_1\", \"CONMEDIC\\_1\", \"CONMEDIC\\_1\", \"CONMEDIC\\_1\") \\\\ \ncontv & CONTV & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? i.                         Television. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/328\"), c(\"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\") & c(9.4, 48.2, 42.3, NA, NA, NA, 100), c(\"124\", \"634\", \"556\", \"671\", \"14\", \"1\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\", \"CONTV\\_1\") \\\\ \nconjudge & CONJUDGE & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? j. U.S.                    Supreme Court. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/286\"), c(\"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\") & c(31.8, 50.3, 17.8, NA, NA, NA, 100), c(\"410\", \"649\", \"230\", \"671\", \"38\", \"2\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\", \"CONJUDGE\\_1\") \\\\ \nconsci & CONSCI & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? k.                         Scientific community. & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/319\"), c(\"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\") & c(41.6, 51, 7.3, NA, NA, NA, 100), c(\"527\", \"646\", \"93\", \"671\", \"62\", \"1\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\", \"CONSCI\\_1\") \\\\ \nconlegis & CONLEGIS & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? l. Congress & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/292\"), c(\"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\") & c(10.8, 51.2, 37.9, NA, NA, NA, 100), c(\"141\", \"666\", \"493\", \"671\", \"28\", \"1\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", \"9\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", NA, \"Total\"), c(\"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\", \"CONLEGIS\\_1\") \\\\ \nconarmy & CONARMY & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? m. Military & c(\"Data type\", \"Missing-data codes\", \"Record/column\"), c(\"numeric\", \"0,8,9\", \"1/244\"), c(\"CONARMY\\_1\", \"CONARMY\\_1\", \"CONARMY\\_1\") & c(46.8, 39.8, 13.4, NA, NA, 100), c(\"613\", \"521\", \"175\", \"671\", \"20\", \"2,000\"), c(\"1\", \"2\", \"3\", \"0\", \"8\", NA), c(\"A GREAT DEAL\", \"ONLY SOME\", \"HARDLY ANY\", \"IAP\", \"DK\", \"Total\"), c(\"CONARMY\\_1\", \"CONARMY\\_1\", \"CONARMY\\_1\", \"CONARMY\\_1\", \"CONARMY\\_1\", \"CONARMY\\_1\") \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\nLevels labels for answers to confidence questions are:\n\n<!-- Missing-data codes are `0,8,9` -->\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfoo <- gss_panel_doc |>\n   filter(id %in% confidence_ids) |> \n   select(-ends_with(\"2\"), -ends_with(\"3\")) |> \n   unnest(\n    cols=c(properties_1), names_repair = \"universal\") |> \n   unnest(\n    cols=c(marginals_1), names_repair = \"universal\") |> \n   head(6) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nNew names:\n* `id` -> `id...1`\n* `id` -> `id...6`\n```\n\n\n:::\n\n```{.r .cell-code}\nfoo |> gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{llllllrrrll}\n\\toprule\nid...1 & description & text & property & value...5 & id...6 & percent & n & value...9 & label & id...11 \\\\ \n\\midrule\\addlinespace[2.5pt]\nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & 30.1 & 395 & 1 & A GREAT DEAL & CONFINAN\\_1 \\\\ \nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & 55.2 & 725 & 2 & ONLY SOME & CONFINAN\\_1 \\\\ \nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & 14.7 & 193 & 3 & HARDLY ANY & CONFINAN\\_1 \\\\ \nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & NA & 671 & 0 & IAP & CONFINAN\\_1 \\\\ \nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & NA & 16 & 8 & DK & CONFINAN\\_1 \\\\ \nconfinan & CONFINAN & far as the people running these institutions are concerned,                     would you say you have a great deal of confidence, only some                    confidence, or hardly any confidence at all in them? a. Banks                   and financial institutions. & Data type & numeric & CONFINAN\\_1 & 100.0 & 2,000 & NA & Total & CONFINAN\\_1 \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\n- `IAP` stands for respondent was not asked the question.\n- `DK` stands for *Don't Know*\n\n\n> If respondents were not given the opportunity to provide a response to a question \n> because it was not included in the survey they were administered, then their responses are coded as “IAP.”\n\n:::\n\n:::::\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npanel_doc <- gssrdoc::gss_panel_doc\n```\n:::\n\n\n\n\n\n\n\n## Table wrangling\n\n\nBefore proceeding to Multiple Correspondence  Analysis (CA), let us select the set of active variables.\n\n::: {.callout-note  title=\"Question\"}\n\nProject `gss_panel10_long` on `firstid, wave, id, sex,`  and columns with names in \n\n```\n  confinan conbus conclerg coneduc confed conlabor conpress conmedic contv conjudge consci conlegis conarmy\n```\n\nFilter so as to keep only wave `1`. \n\nTransform all relevant columns into factors. \n\n:::\n\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_panel10 <- gss_panel10_long |> \n  filter(wave==1) |>\n  select(firstid, wave, id, sex, contains(confidence_ids)) |>\n  mutate(across(starts_with(\"con\"), as_factor)) |>\n  mutate(sex=as_factor(sex))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_10 <- gss_panel_doc |>\n   filter(id %in% confidence_ids) |> \n   select(-ends_with(\"2\"), -ends_with(\"3\")) |> \n   unnest(\n    cols=c(properties_1), names_repair = \"universal\") |> \n   unnest(\n    cols=c(marginals_1), names_repair = \"universal\") |>\n   mutate(text=str_squish(text)) |>\n   mutate(text= str_match(text, \"\\\\? [\\\\w]\\\\.(.*)\")) |> \n   mutate(text=text[,2]) |> \n   filter(property == \"Missing-data codes\") |>\n   select(-starts_with(\"id\"), -property, -`value...5`)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nNew names:\n* `id` -> `id...1`\n* `id` -> `id...6`\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels_table <- confidence_10 |> \n  filter(label!='Total' | is.na(label)) |>\n  distinct(`value...9`, label)\n```\n:::\n\n\n\n\n\n\n\n:::\n\n:::\n\n\n## Elementary statistics\n\n\n::: {.callout-note  title=\"Question\"}\n\nUse `skimmr` to summarize your dataset. \n\n:::\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n\n::: {.callout-tip title='Solution'} \n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_panel10 |>\n  skimr::skim(where(is.factor)) |>\n  select(-factor.ordered, -skim_type)|>\n  filter(str_starts(skim_variable,\"con\")) |>\n  gt::gt() |>\n  gt::fmt_number(decimals=3) |>\n  gt::tab_caption(\n    caption = \"GSS Panel data 2010 First wave, Topic confidence\"\n  )\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{lrrrl}\n\\toprule\nskim\\_variable & n\\_missing & complete\\_rate & factor.n\\_unique & factor.top\\_counts \\\\ \n\\midrule\\addlinespace[2.5pt]\nconfinan & 680.000 & 0.667 & 3.000 & ONL: 656, HAR: 564, A G: 144, IAP: 0 \\\\ \nconbus & 705.000 & 0.655 & 3.000 & ONL: 848, HAR: 317, A G: 174, IAP: 0 \\\\ \nconclerg & 725.000 & 0.645 & 3.000 & ONL: 720, HAR: 328, A G: 271, IAP: 0 \\\\ \nconeduc & 681.000 & 0.667 & 3.000 & ONL: 793, A G: 367, HAR: 203, IAP: 0 \\\\ \nconfed & 698.000 & 0.659 & 3.000 & ONL: 620, HAR: 499, A G: 227, IAP: 0 \\\\ \nconlabor & 744.000 & 0.636 & 3.000 & ONL: 781, HAR: 373, A G: 146, IAP: 0 \\\\ \nconpress & 689.000 & 0.663 & 3.000 & ONL: 621, HAR: 594, A G: 140, IAP: 0 \\\\ \nconmedic & 681.000 & 0.667 & 3.000 & ONL: 647, A G: 558, HAR: 158, IAP: 0 \\\\ \ncontv & 681.000 & 0.667 & 3.000 & ONL: 677, HAR: 521, A G: 165, IAP: 0 \\\\ \nconjudge & 709.000 & 0.653 & 3.000 & ONL: 706, A G: 400, HAR: 229, IAP: 0 \\\\ \nconsci & 738.000 & 0.639 & 3.000 & ONL: 683, A G: 544, HAR: 79, IAP: 0 \\\\ \nconlegis & 697.000 & 0.659 & 3.000 & ONL: 635, HAR: 587, A G: 125, IAP: 0 \\\\ \nconarmy & 688.000 & 0.663 & 3.000 & A G: 720, ONL: 507, HAR: 129, IAP: 0 \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_panel10 |>\n  filter(is.na(conarmy)) |>\n  filter(is.na(conclerg)) |>\n  filter(is.na(conpress))\n```\n:::\n\n\n\n\n\n\n:::\n:::\n\n\n::: {.callout-note  title=\"Question\"}\n\nThere are a lot of missing data in your data set.\n\nHow are missing cells related? \n\nDrop rows with missing data in the confidence questions. \n\nWhat are the dimensions of your data set? \n\n:::\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n\n::: {.callout-tip title='Solution'} \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_data <- confidence_panel10 |> \n  mutate(across(starts_with(\"con\"), .fns=\\(x) !is.na(x), .names=\"not_{.col}_isna\")) |>\n  rowwise() |>\n  filter(all(c_across(ends_with(\"isna\")))) |> \n  ungroup() |> \n  select(-ends_with(\"isna\"), -firstid, -wave, -econsci) |>\n  mutate(across(starts_with(\"con\"), fct_drop), sex=as_factor(sex))\n\nconfidence_data |> \n  slice_sample(n=10) |> \n  gt::gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{ccccccccccccccc}\n\\toprule\nid\\_1: id & sex\\_1: RESPONDENTS SEX & confinan\\_1: CONFID IN BANKS \\& FINANCIAL INSTITUTIONS & conbus\\_1: CONFIDENCE IN MAJOR COMPANIES & conclerg\\_1: CONFIDENCE IN ORGANIZED RELIGION & coneduc\\_1: CONFIDENCE IN EDUCATION & confed\\_1: CONFID. IN EXEC BRANCH OF FED GOVT & conlabor\\_1: CONFIDENCE IN ORGANIZED LABOR & conpress\\_1: CONFIDENCE IN PRESS & conmedic\\_1: CONFIDENCE IN MEDICINE & contv\\_1: CONFIDENCE IN TELEVISION & conjudge\\_1: CONFID. IN UNITED STATES SUPREME COURT & consci\\_1: CONFIDENCE IN SCIENTIFIC COMMUNITY & conlegis\\_1: CONFIDENCE IN CONGRESS & conarmy\\_1: CONFIDENCE IN MILITARY \\\\ \n\\midrule\\addlinespace[2.5pt]\n453 & MALE & ONLY SOME & A GREAT DEAL & A GREAT DEAL & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME \\\\ \n1064 & FEMALE & HARDLY ANY & ONLY SOME & A GREAT DEAL & A GREAT DEAL & A GREAT DEAL & A GREAT DEAL & HARDLY ANY & ONLY SOME & HARDLY ANY & ONLY SOME & ONLY SOME & HARDLY ANY & A GREAT DEAL \\\\ \n19 & MALE & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME \\\\ \n1087 & FEMALE & ONLY SOME & ONLY SOME & A GREAT DEAL & ONLY SOME & ONLY SOME & HARDLY ANY & HARDLY ANY & A GREAT DEAL & HARDLY ANY & A GREAT DEAL & ONLY SOME & ONLY SOME & A GREAT DEAL \\\\ \n1585 & FEMALE & HARDLY ANY & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & A GREAT DEAL & HARDLY ANY \\\\ \n808 & MALE & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & HARDLY ANY & HARDLY ANY & HARDLY ANY & A GREAT DEAL & ONLY SOME & ONLY SOME & A GREAT DEAL & HARDLY ANY & A GREAT DEAL \\\\ \n83 & FEMALE & HARDLY ANY & HARDLY ANY & HARDLY ANY & ONLY SOME & HARDLY ANY & ONLY SOME & HARDLY ANY & ONLY SOME & ONLY SOME & HARDLY ANY & ONLY SOME & HARDLY ANY & A GREAT DEAL \\\\ \n67 & MALE & ONLY SOME & HARDLY ANY & ONLY SOME & A GREAT DEAL & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & ONLY SOME & A GREAT DEAL & A GREAT DEAL & ONLY SOME & A GREAT DEAL \\\\ \n973 & FEMALE & A GREAT DEAL & ONLY SOME & ONLY SOME & ONLY SOME & HARDLY ANY & ONLY SOME & HARDLY ANY & ONLY SOME & HARDLY ANY & ONLY SOME & ONLY SOME & HARDLY ANY & A GREAT DEAL \\\\ \n1408 & MALE & HARDLY ANY & A GREAT DEAL & ONLY SOME & HARDLY ANY & HARDLY ANY & A GREAT DEAL & HARDLY ANY & A GREAT DEAL & HARDLY ANY & ONLY SOME & ONLY SOME & HARDLY ANY & A GREAT DEAL \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n\n\n\n\n:::\n\n:::\n\n\n\n\n\n::: {.callout-note title='Question'} \n \nIn your explore possible associations between the answers to the different *confidence* questions?\n\nHow would you test possible independence between answer to *confidence in science* and *confidence in the Army*. \n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n \nTODO \n\n:::\n:::\n\n\n\n## The case for using MCA \n\n> In order to construct a *field of ideological and political attitudes*, which will subsequently\nbe used as a reference for locating the empirical typologies of response styles and survey\ncompliance, we apply *multiple correspondence analysis* (MCA). MCA belongs to the\nfamily of techniques used in geometric data analysis (Le Roux and Rouanet 2004). It\nallows for the extraction of the most important dimensions in a set of categorical variables,\nand the graphical representation of variable categories and individuals relative to each\nother in a coordinate system. Distances between categories as well as individuals can be\ninterpreted as a measure of (dis)similarity: If categories often co-appear in individual's\nresponses, they are located close together in the space produced by MCA. Rare co-appearances, \naccordingly, result in a larger distance between the respective categories.\nFurthermore, *illustrative variables* can passively be projected into the field, a technique that\nhas been termed *visual regression analysis* (Lebart et al. 1984). Whereas the space is\ndetermined by the distances between the categories of *active variables*, *passive variables*\ndo not alter the structure of the constructed field, but appear in their average and hence\nmost likely position.\n\nFrom [https://doi.org/10.1007/s11135-016-0458-3](https://doi.org/10.1007/s11135-016-0458-3)\n\n\nIn this lab, we won't look at the field of ideological and political attitudes, but rather at the field of confidence level in a variety of institutions. \n\n\n\n\n## Multiple Correspondance Analysis\n\n\n::: {.callout-important}\n\n### MCA executive summary\n\nThe input of multiple correspondence analysis is a data frame $X$ with $n$ rows and $p$ categorical columns. Multiple Correspondence Analysis starts by building the *indicator matrix*. The indicator matrix is built by *one-hot encoding* of each categorical variable.\n\n\n- A categorical variable $V_j$ (factor) with $q$ levels is mapped to $q$ $\\{0,1\\}$ -valued variables $V_{j,r}$ for $r \\leq q$\n\n- If levels are indexed by $\\{1, \\ldots, q\\}$, if the value of the categorical variable $V_j$ from row $i$  is $k \\in \\{1, \\ldots, q\\}$, the bina$\n$$k \\mapsto \\underbrace{0,\\ldots, 0}_{k-1}, 1, \\underbrace{0, \\ldots, 0}_{q-k}$$\n\n- The indicator matrix has as many rows as the data matrix\n\n- The number of columns of the indicator matrix is the sum of the number of levels of the categorical variables/columns of the data matrix\n\n- The indicator matrix is a numerical matrix. It is suitable for factorial methodss\n\n\nRecall $X$ is the data matrix with $n$ rows (individuals) and $p$ categorical columns (variables)\n\nFor $j \\in \\{1, \\ldots, p\\}$, let $J_j$ denote the number of levels(categories) of variable $j$\n\nLet $q = \\sum_{j\\leq p} J_j$ be the sum of the number of levels throughout the variables\n\n\nLet $Z$ be the incidence matrix with $n$ rows and $q$ columns\n\nFor $j\\leq p$ and $k \\leq J_j$, let $\\langle j, k\\rangle = \\sum_{j'<j} J_{j'}+k$\n\nLet $N = n \\times p = \\sum_{i\\leq n} \\sum_{j \\leq p} X_{i,j}$ and\n$$P = \\frac{1}{N} Z$$\n\n(the _correspondence matrix_ for MCA)\n\n{{< fa hand-point-right >}} The row wise  sums of correspondence matrix $P$ are all equal to $1/n=p/N$\n\nThe column wise sum of the correspondence matrix $P$ for the $k$th level of the $j$th variable of $X$ ( $j \\leq p$ ) is\n$$N_{\\langle j,k\\rangle}/N = f_{\\langle j,k\\rangle}/p$$\n\nwhere $f_{\\langle j,k\\rangle}$ stands for the relative frequency of level $k$ of the $j$th variable\n\n$$D_r = \\frac{1}{n}\\text{Id}_n\\qquad D_c =\\text{diag}\\left(\\frac{f_{\\langle j,k\\rangle}}{p}\\right)_{j \\leq p, k\\leq J_j}$$\n\nIn MCA, we compute the SVD $U \\times D \\times V^\\top$ of the *standardized residuals matrix*:\n\n$$S = D_r^{-1/2}\\times \\left(P - r\\times c^\\top\\right) \\times D_c^{-1/2} = \\sqrt{n}\\left(P - r\\times c^\\top\\right) \\times D_c^{-1/2}$$\n\nCoefficient $i, \\langle j, k\\rangle$  of $S$ is\n$$\\frac{\\mathbb{I}_{i, \\langle j, k\\rangle}- f_{\\langle j,k\\rangle}}{\\sqrt{n f_{\\langle j,k\\rangle}/p}}$$\n   \n   \n\n\n\nMCA consists in computing the SVD of the standardized residuals matrix $S =  U  \\times D \\times V^\\top$\n\nFrom the SVD, we get\n\n- $D_r^{-1/2} \\times U$ *standardized coordinates of rows*\n- $D_c^{-1/2} \\times V$ *standardized coordinates of columns*\n- $D_r^{-1/2} \\times U \\times D$ *principal coordinates of rows*\n- $D_c^{-1/2} \\times V \\times D$ *principal coordinates of columns*\n- Squared singular values: the principal *inertia*\n\n\nWhen calling `svd(.)`, the argument should be\n$$D_r^{1/2}\\times \\left(D_r^{-1} \\times P \\times D_c^{-1}- \\mathbf{I}\\times \\mathbf{I}^\\top  \\right)\\times D_c^{1/2}= D_r^{-1/2}\\times \\left( P - r \\times c^\\top  \\right)\\times D_c^{-1/2}$$\n\n\n:::\n\n\n::: {.callout-important title=\"MCA and extended SVD\"}\n\nAs\n\n$$D_r^{-1} \\times P \\times D_c^{-1} - \\mathbf{I}\\mathbf{I}^\\top = (D_r^{-1/2} \\times U)\\times D \\times (D_c^{-1/2}\\times V)^\\top$$\n\n$$(D_r^{-1/2} \\times U)\\times D \\times (D_c^{-1/2}\\times V)^\\top$$ \n\nis the _extended SVD_ of\n\n$$D_r^{-1} \\times P \\times D_c^{-1} - \\mathbf{I}\\mathbf{I}^\\top$$\n\nwith respect to $D_r$ and $D_c$\n\n\n:::\n\n\n::: {.callout-note title=\"Question\"}\n\n\nPerform MCA on the indicator matrix. \n\n:::\n\n::: {.callout-tip}\n\nYou may use `FactoMineR::MCA()`. It is interesting to compute the correspondence analysis in your own way, by preparing the matrix that is handled to `svd()` and returning \na named list containing all relevant information. \n\n:::\n\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n We lazyly rely on `FactoMineR::MCA`. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.mca <- confidence_data |> \n  select(starts_with(\"con\")) |> \n  FactoMineR::MCA(graph=F)\n```\n:::\n\n\n\n\n\n\nThe result is an object of `S3` class `MCA`. \n\n:::\ns\n:::::\n\n\n::: {.callout-note title=\"Question\"}\n\nIf you did use `FactoMineR::MCA()`, explain the organization of the result.\n\n:::\n\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \nThe result of `FactoMineR::MCA(...)` is a named and nested list with five elements:\n\n`eig`\n: a matrix/array containing enough information to build a screeplot.\n\n`call`\n: a list of 9, containing the call to `CA()`, an object of type `language`, telling (in principle) the user how `CA()` was called. However, this is a *quoted expression*. Here we need to guess the value of `y` in the calling environment understand what's going on. \n\n\nElement `call` also contains the table margin distributions `marge.col` and `marge.row`. The truncation rank `ncp` (number of components) can be assigned before computing the SVD (default value is 5). Element $X$ stores the contingency table that was effectively used for computing Correpondence Analysis. \n\n`ind`\n: Information gathered from SVD to facilitate individulals (respndents)  analysis. \n\n`var`\n: a list structured in the same way as element `ind`. Used for variables/categories profiles analysis\n\n`svd`\n: a list of 3, just as the resuld of `svd()` containing the singular values, the left and right singular vectors of matrix $...$\n\n:::\n\n::: {.callout-tip title='Solution, output of  `print(res.mca)`'} \n\n   \n|   | Name   |             Description                                          |\n|:-:|:------------------------|:----------------------------------------------------|\n|1  |   `$eig`                |\"eigenvalues\"                                        |\n|2  |   `$var`                |\"results for the variables (categories)\"                          |\n|3  |   `$var$coord`          |\"coord. of the categories\"                           |\n|4  |   `$var$cos2`           |\"cos2 for the categories\"                           |\n|5  |   `$var$contrib`        |\"contributions of the categories\"                    |\n|6  |   `$var$v.test`         |\"v-test for the categories\"                          |\n|7  |   `$ind`                |\"results for the individuals\"                        |\n|8  |   `$ind$coord`          |\"coord. for the individuals\"                         |\n|9  |   `$ind$cos2`          |\"cos2 for the individuals\"                          |\n|10 |   `$ind$contrib`        |\"contributions of the individuals\"                   |\n|11 |  `$quali.sup`          |\"results for the supplementary categorical variables\"|\n|12 |  `$quali.sup$coord`    |\"coord. for the supplementary categories\"            |\n|13 |  `$quali.sup$cos2`     |\"cos2 for the supplementary categories\"              |\n|14 |  `$quali.sup$v.test`   |\"v-test for the supplementary categories\"            |\n|15 |  `$call`               |\"intermediate results\"                               |\n|16 |  `$call$marge.col`     |\"weights of columns\"                                 |\n|17 |  `$call$marge.li`      |\"weights of rows\"                                    |\n\n\n\n{{< fa exclamation-triangle >}}  `res.mca$svd` is not part of the output! \n\n- `eig` is computed from the singular values in `res.mca$svd`\n\n- `var` contains material for plotting information about categories and variables on factorial planes\n\n- `ind` conatins material for plotting information about individuals on on factorial planes\n\n\n:::\n\n::: {.callout-warning}\n\nIn principle, all relevant information can be gathered from components `svd`, `call.marge.li`, and `call.marge.col`. \n\n:::\n\n:::::\n\n\n## Screeplots\n\n\n::: {.callout-note title=\"Question\"}\n\nDraw screeplots. Why are they useful? Comment briefly. \n\n:::\n\n\n\n::::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \nWe first define a tidying function for preparing the screeplot. \nIt is designed along the lines of method `tidy` for objects of class `prcomp`.\nIt consists in building a data frame from component `eig` of the `MCA` object.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_mca_scree <- function(res_mca){\n  res_mca$eig |> \n    as_tibble(rownames=\"Dim\") |>\n    rename(\n      `% Inertia` = `percentage of variance`,\n      `Cumulative % Inertia` = `cumulative percentage of variance`\n    ) |> \n    mutate(\n      PC = as.integer(str_match(Dim, 'dim ([0-9]*)')[,2])\n    )\n}\n```\n:::\n\n\n\n\n\n\nWe can now build a column plot. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.mca |> \n  tidy_mca_scree() |>\n  ggplot() +\n  aes(x=PC, y=eigenvalue, label=glue(\"{round(`% Inertia`,2)} %\")) +\n  geom_col() +\n  geom_text(angle=45, vjust=-1, hjust=-.1) \n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/tidy-scree-plot-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\nNote that the share of cumulated inertia doesn't grow very fast with the number of components. Situation is different from what we met when performing Correspondence Analysis or Principal Component Analysis. This tells us that we will hqve to look beyond the first two axis. This is commonplace with multiple correspondence analysis. Look at the reference below where most of the interesting information can be found on the 3rd and 4th axis. \n\n::: \n\n:::::\n\n\n\n\n\n## Individuals\n\n\n::: {.callout-note title=\"Question\"}\n\nPerform Individual profiles analysis.\n\nWhat are the classical plots? How can you build them from the output of `FactoMiner::MCA`? \n\nBuild the table of row contributions (the so-called $\\cos^2$)\n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n\nAttribute `ind` of objects of class `MCA` (exported from `FactoMineR`) is the starting point of any \nrow profiles analysis. \n\nWe design an augment method. For objects of class `MCA`. This is like what is done for objects of class `prcomp` and  different from what we did with objects of class `CA`. Indeed, `MCA` on the indicator matrix handles a sample just like `PCA` and not a contingency table like `CA`.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naugment_mca <- function(res_mca, data=NULL){\n  \n  result <- res_mca$ind$coord |> \n    as_tibble()  \n  \n  if (!is.null(data)) {\n    result <- result |>\n      bind_cols(confidence_data)\n      # inner_join(confidence_data, by=c(\"id\")) \n  }\n  \n  return(result)\n}\n```\n:::\n\n\n\n\n\n\n\n:::\n\n\n::: {.callout-tip title='Solution'} \n\nAttribute `ind` is a named list made of $4$ components. \n\n\n`coord`\n: a matrix with *named* rows and columns. The number of rows of `coord` matches the number of rows of the table fed to `MCA` (here, the number of respondents in the panel). The number of columns matches the rank of the truncated SVD that underlies Multiple Correspondance Analysis. Here it is the default truncation $5$.\n\n> The principal coordinates are the principal coordinates of each individual in terms of the principal component. \n\nThe columns of `coord` are pairwise orthogonal in the usual  inner product space.\n\nFunction `augment_mca` Bind the columns of `coord` with the columns of the original dataset.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.mca |> \n#| label: augment_mca_glimpse\n  augment_mca(confidence_data) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,183\nColumns: 20\n$ `Dim 1`  <dbl> 1.35465733, -0.10861408, -0.33683136, 0.72450001, 0.72525336,~\n$ `Dim 2`  <dbl> 0.41190167, -0.90245225, -0.45183706, 0.25425970, 0.10225521,~\n$ `Dim 3`  <dbl> 0.161371575, 0.010268886, 0.107542556, -0.009273224, -0.38139~\n$ `Dim 4`  <dbl> 0.141129674, 0.310980059, -0.097880877, -0.085996832, 0.36106~\n$ `Dim 5`  <dbl> 0.227285260, 0.086562193, 0.016680275, -0.115998402, -0.06681~\n$ id       <dbl+lbl>  4,  6,  7,  9, 11, 15, 19, 20, 21, 24, 26, 28, 31, 41, 4~\n$ sex      <dbl+lbl> 2, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 2, 1, ~\n$ confinan <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, HARDLY ANY, ONLY SOME, ON~\n$ conbus   <fct> ONLY SOME, ONLY SOME, ONLY SOME, ONLY SOME, ONLY SOME, ONLY S~\n$ conclerg <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, A GREAT DEAL, A GREAT DEA~\n$ coneduc  <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, ONLY SOME, A GREAT DEAL, ~\n$ confed   <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, A GREAT DEAL, A GREAT DEA~\n$ conlabor <fct> A GREAT DEAL, ONLY SOME, HARDLY ANY, ONLY SOME, HARDLY ANY, O~\n$ conpress <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, HARDLY ANY, ONLY SOME, HA~\n$ conmedic <fct> A GREAT DEAL, ONLY SOME, HARDLY ANY, A GREAT DEAL, ONLY SOME,~\n$ contv    <fct> ONLY SOME, ONLY SOME, HARDLY ANY, ONLY SOME, ONLY SOME, ONLY ~\n$ conjudge <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, A GREAT DEAL, A GREAT DEA~\n$ consci   <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, A GREAT DEAL, ONLY SOME, ~\n$ conlegis <fct> ONLY SOME, ONLY SOME, ONLY SOME, A GREAT DEAL, A GREAT DEAL, ~\n$ conarmy  <fct> A GREAT DEAL, ONLY SOME, ONLY SOME, A GREAT DEAL, A GREAT DEA~\n```\n\n\n:::\n:::\n\n\n\n\n\n\nNote that, we can recover `ind$coord` from the left singular vectors and the singular values.\n\nThe output of `augment_mca` is the basis of the individual plots.  Individual plots are defined by picking a pair of principal axes. \nHim use the 3rd and the 4th axis, and we map the `sex` column from the original dataset  to the `fill` aesthetics.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.mca |> \n  augment_mca(confidence_data) |> \n  ggplot() +\n  aes(x=`Dim 3`, y=`Dim 4`, fill=sex) +\n  geom_point(alpha=.2, size=.2) +\n  coord_fixed() +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/augment_mca_plot-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n:::\n\n\n\n::: {.callout-tip title='Solution'} \n \n`cos2`\n: Coefficients of matrix `cos2` are the share of row inertia from the corresponding cell in `coord`\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.mca |> \n  augment_mca(confidence_data) |> \n  ggplot() +\n  aes(x=`Dim 1`, y=`Dim 2`, fill=sex) +\n  geom_point(alpha=.2, size=.2) +\n  coord_fixed() +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/augment_mca_cos2_TODO-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n:::\n\n::: {.callout-tip title='Solution'} \n \n`contrib`\n: \n\nNot too surprisingly, `coord`, `contrib`, and `cos2` share the same row names and column names.   \n\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n\n:::\n\n\n\n:::::\n\n\n \n\n\n\n\n\n\n## Variables/Categories\n\n\n::: {.callout-note title='Question'} \n \nPerform  column profiles (categories) analysis. You may use `factoextra::fviz_mca_var()`\n\n:::\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n\nThe `var` component. Of an MCA object is related with the right singular vectors of the residual matrix. \n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- res.mca |> \n  factoextra::fviz_mca_var() +\n  coord_fixed() \n  \np +\n  facet_zoom(\n    xy=`Dim 1`>=0 & `Dim 2`>=0,\n    xlim=c(0,2),ylim=c(0,2))\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/zooming_var_mca-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\nFollowing what has been done for objects of class `prcomp`, we design  a `tidy_mca_var` function that turns the `var` component into a dataframe. Row names which correspond to categories, are  turned into a column we call `levels`. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_mca_var <- function(res_mca){\n  res_mca$var$coord |> \n  as_tibble(rownames=\"levels\")\n}\n```\n:::\n\n\n\n\n\n\nA value in column `levels` indicate a variable., that is a topic (science, religion, army, ...) and a confidence level (A value on a Likert scale). We enrich the data frame by extracting the variable (`topic`) and the value (`sentiment`). \n\nWe are then ready to plot an analog of the correlation circle. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidied_mca_var <- tidy_mca_var(res.mca) |>   \n  mutate(sentiment=str_split(as.character(levels),'_')) |>\n  mutate(topic=map_chr(sentiment, \\(x)x[1]), sentiment=map_chr(sentiment, \\(x)x[2])) \n\np <- tidied_mca_var |> \n  ggplot() +\n    aes(x=`Dim 1`, y=`Dim 2`, label=levels, fill=topic, shape=sentiment) +\n    geom_point(alpha=.5, show.legend = F) +\n    coord_fixed() +\n    scale_color_viridis_d() +\n    theme(legend.position=\"none\") +\n    labs(\n      title = \"MCA: Variables categories\",\n      subtitle = \"Color: topic, Shape: confidence level\",\n      caption = \"GSS data, panel 2010, wave 1\"\n    )\n\np |>\n  plotly::ggplotly() \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////tmp/Rtmpvzl1h5/file532a61d6efb3/widget532a7f0089bb.html screenshot completed\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/tidy_mca_var_plotly_1_2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\nResorting to `plotly` allows us  to mitigate the overplotting effect. \n\nThe plot on the first two axes seems  easy to interpret. As we move along the first axis from the left, we see growing confidence.  \nOn the positive part of the second axis, we have extreme confidence levels, either high or low. This suggests that individuals have trends:  either we trust all institutions; or none of them; or finally a little bit all of them. \n\nHow could we comfort such a narrative?\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(\n p + \n    aes(x=`Dim 3`, y=`Dim 4`, label=levels, color=sentiment) \n) |>   plotly::ggplotly() \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////tmp/Rtmpvzl1h5/file532ad74acd4/widget532a76529e85.html screenshot completed\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/tidy_mca_var_plotly_3_4-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n(\n  p +\n    aes(x=`Dim 4`, y=`Dim 5`, label=levels) \n) |>  plotly::ggplotly() \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////tmp/Rtmpvzl1h5/file532a3c39a4bf/widget532a71b39832.html screenshot completed\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/tidy_mca_var_plotly_4_5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n:::\n\n:::::\n\n::: {.callout-note title='Question'} \n\nWhat is the `v.test` component of the `var`  component of an `MCA` object?\n \n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n\nHere is a chatbot answer:\n\n> In *Multiple Correspondence Analysis (MCA)*, the *v-test* (also known as the *test-value* or *t-test value*) is a statistical measure used to assess the *significance of the association* between a category and a dimension (factor). It helps determine which categories contribute the most to the definition of a given dimension.\n\n### **Definition and Calculation**\n\nThe v-test is computed as:\n\n\n$$v = \\frac{p - P}{\\sqrt{P(1 - P)/n}}$$\n\n\nwhere:\n- $p$ = proportion of individuals in a given category for the specific dimension,\n- $P$ = overall proportion of individuals in that category across all dimensions,\n- $n$ = total number of individuals.\n\nAlternatively, the v-test can also be expressed as:\n\n$$v = \\frac{\\text{category coordinate}}{\\text{standard deviation of the coordinate}}$$\n\nThis essentially provides a **z-score**, which follows a standard normal distribution under the null hypothesis.\n\n### Interpretation\n\n- A *high absolute v-test value* (typically above 2 or below -2) indicates that the category is *strongly associated* with the given dimension.\n- *Positive v-test*: The category is overrepresented in that dimension.\n- *Negative v-test*: The category is underrepresented in that dimension.\n- If the absolute value of the v-test is below 2, the association is **not statistically significant** (at a 5% significance level).\n\n### *Why is it useful?*\n\n- It helps *interpret MCA results quantitatively* rather than relying only on visual inspection.\n- It aids in identifying *key categories* that structure the data on a given axis.\n- It provides statistical validation for category contributions to dimensions.\n\nWould you like a practical example or interpretation of a specific MCA result?\n\n:::\n\n:::\n\n\n## Symmetric plots \n\n::: {.callout-note title=\"Question\"}\n\nBuild the symmetric plots (biplots)  for multiple correspondence analysis.\n\n\n:::\n\n\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.content-visible when-profile='solution'} \n \n### From the shelf \n\nWe resort to `factoextra`. In principle, the biplot can be constructed  from the `coord` matrices  in the `var` and the `ind` components of the  `MCA` object.  \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- res.mca |> \n  factoextra::fviz_mca_biplot(\n    label= \"var\",\n    alpha.ind=.5\n  )\n\np\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/biplot-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# p |>  plotly::ggplotly()\n```\n:::\n\n\n\n\n\n\n:::\n\n\n::: {.callout-tip title='Solution'} \n\n### {{< fa jedi >}}\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n:::\n\n:::::\n\n\n\n\n\n## Mosaicplots\n\n\nMCA can be complemented by  Mosaicplots, Double Decker plots,  Chi-square tests, and  Correspondence analyses between pair of variables. \n\n::: {.callout-note title=\"Question\"}\n\nDraw a mosaic plot to visualize association between confidence levesl in Science and confidence level in Medicine. \n\n:::\n\n\n\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_data |> \n  select(consci, conmedic) |>\n  table() |> \n  mosaicplot(color=T)\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/unnamed-chunk-21-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_data |> \n  select(consci, conmedic) |> \n  table() |>\n  chisq.test() |> \n  broom::glance() |> \n  gt::gt() |> \n  gt::tab_caption(\"Chi2 independence test for Confidence in Science and Confidence in Medicine\")\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{rrrl}\n\\toprule\nstatistic & p.value & parameter & method \\\\ \n\\midrule\\addlinespace[2.5pt]\n137.8878 & 7.994493e-29 & 4 & Pearson's Chi-squared test \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfidence_data |> \n  select(consci, conclerg) |> \n  table() |>\n  chisq.test() |> \n  broom::glance() |> \n  gt::gt() |> \n  gt::tab_caption(\"Chi2 independence test for Confidence in Science and Confidence in Clergy\")\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{rrrl}\n\\toprule\nstatistic & p.value & parameter & method \\\\ \n\\midrule\\addlinespace[2.5pt]\n39.27785 & 6.103953e-08 & 4 & Pearson's Chi-squared test \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nt_sex_clerg_sci <- confidence_data |> \n  select(sex, conclerg, consci) |> \n  table()\n  \nt_sex_clerg_sci  |>\n  vcd::doubledecker( )\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/unnamed-chunk-24-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nt_sex_clerg_sci |> \n  mosaicplot(color=T, main=\"Confidence in Clergy and Science\")\n```\n\n::: {.cell-output-display}\n![](lab-mca_files/figure-pdf/unnamed-chunk-25-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n:::\n\n:::::\n\n\n## Further references \n\n\nBarth, Alice and Schmitz, Andreas. 2018. *Response quality and ideological dispositions: an integrative approach using geometric and classifying techniques*. Quality & Quantity\n\n> When analyzing survey data, response quality has consequential implications for substantial conclusions. Differences in response quality are usually explained by personality, or socio-demographic or cognitive characteristics. Little, however, is known about how respondents’ political attitudes, values, and opinions impact on quality aspects. This is a striking analytical omission, as potential associations between political values and various forms of response biases and artefacts call into question surveys’ ability to represent ‘public opinion’. In this contribution, response quality is traced back to respondents’ political and ideological dispositions. For this purpose, a relational understanding of response quality is applied that takes into account different aspects of response behaviors, as well as the interrelations between these indicators. Using data from the US General Social Survey (2010–2014), an empirical typology of response quality is created via finite mixture analysis. The resulting classes are then related to positions in the US field of ideological dispositions constructed via multiple correspondence analysis. The analyses reveal that there are (1) different combinations of response patterns and thus different empirical response types, and (2) that these types of response quality systematically vary with regard to the respondents’ political and ideological (dis)positions. Implications of the findings for public opinion surveys are discussed.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n\\usepackage{anyfontsize}\n\\usepackage{multirow}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}