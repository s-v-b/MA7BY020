{
  "hash": "442cec2e3ffb64acf853aefc8a8f87e5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab: Clustering k-means\"\ndate: \"2026-01-16 10:48:57.759842\"\n\nexecute:\n  echo: true\n  eval: true\n  collapse: true\n  message: false\n  warning: false\n\nformat:\n  html:\n    output-file: lab-kmeans.html\n  pdf:\n    output-file: lab-kmeans.pdf\n\nengine: knitr\n---\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Année {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nstopifnot(\n  require(gt),\n  require(sloop),\n  require(lobstr), \n  require(skimr),\n  require(GGally),\n  require(patchwork),\n  require(ggforce),\n  require(glue),\n  require(ggfortify),\n  require(ggvoronoi),\n  require(magrittr),\n  require(broom),\n  require(tidyclust),\n  require(tidyverse)\n)\n\ntidymodels::tidymodels_prefer(quiet = TRUE)\n\nold_theme <-theme_set(\n  theme_minimal(base_size=9, \n                base_family = \"Helvetica\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nknitr::opts_chunk$set(\n  message = FALSE,\n  warning = FALSE,\n  comment=NA,\n  prompt=FALSE,\n  cache=FALSE,\n  echo=TRUE,\n  results='asis'\n)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ngc <- options(ggplot2.discrete.colour=\"viridis\")\ngc <- options(ggplot2.discrete.fill=\"viridis\")\ngc <- options(ggplot2.continuous.fill=\"viridis\")\ngc <- options(ggplot2.continuous.colour=\"viridis\")\n```\n:::\n\nForeword\n--------\n\n\nThis lab is dedicated to the *k-means* clustering method. In words, *k-means* takes as input a collection of points in $\\mathbb{R}^d$ (a numerical dataset) and a positive integer $k$. It returns  a collection of $k$ points (the *centers*) from $\\mathbb{R}^d$. The centers define a Voronoï *tesselation*/*partition*/*diagran* of $\\mathbb{R}^d$. The Voronoï *cells* define a clustering of the original dataset.\n\n\nVoronoi tesselation/partition/diagram\n--------------------------------------\n\n[Wikipedia on Voronoï diagrams](https://en.wikipedia.org/wiki/Voronoi_diagram)\n\nIn the next chunk, we generate a Voronoï diagram on $\\mathbb{R}^2$ with $100$ cells defined from $100$ random points drawn from the uniform distribution on a square. \nFunction `stat_voronoi()` comes from [ggvoronoi](https://github.com/garretrc/ggvoronoi) \n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(45056)\n\npoints <- tibble(\n  x=runif(100, 0, 1),\n  y=runif(100, 0, 1),\n  distance = sqrt((x-100)^2 + (y-100)^2)\n) \n\np <- ggplot(points) +\n    aes(x=x, y=y) +\n    geom_point(size=.2) +\n    coord_fixed() +\n    xlim(c(-.25, 2.25)) +\n    ylim(c(-.25, 2.25)) \n\np + (p + stat_voronoi(geom=\"path\")) +\n  patchwork::plot_annotation(\n    title=\"Voronoi tesselation\",\n    subtitle = \"Left: 100 random points\\nRight: Voronoï diagram\")\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/voronoi-1.png){width=672}\n:::\n:::\n\n::: {.callout-note}\n\n- Two adjacent Voronoï cells are separated by a (possibly semi-infinite)  line segment\n- Let the so-called *centers* be denoted by  $c_1, \\ldots, c_n$. They form the *codebook* $\\mathcal{C}$.  \n- The Voronoï cell with *center*  $c_i$ is defined by \n$$\\left\\{x : x \\in \\mathbb{R}^d, \\qquad \\| x- c_i \\|_2 = \\min_{j \\leq n} \\|x -c_j\\|_2\\right\\}$$\n- The center of a Voronoï cell is usually not its barycenter\n\n:::\n\n_k_-means objective function\n----------------------------\n\n\n\n::: {.callout-note}\n\n### Definition\n\nThe $k$-means algorithm aims at building a _codebook_ $\\mathcal{C}$ that minimizes\n\n$$\\mathcal{C} \\mapsto \\sum_{i=1}^n \\min_{c \\in \\mathcal{C}}  \\Vert X_i - c\\Vert_2^2$$\n\nover all codebooks with given cardinality\n\nIf $c \\in \\mathcal{C}$ is the closest centroid to $X \\in \\mathbb{R}^p$,\n\n$$\\|c - X\\|^2$$ \n\nis the _quantization/reconstruction error_ suffered when using codebook $\\mathcal{C}$ to approximate $X$\n\n:::\n\n::: {.callout-caution}\n\n{{< fa exclamation-triangle >}} If there are no restrictions on the dimension of the input space, on the number of centroids, or on sample size, computing an optimal codebook is a $\\mathsf{NP}$ -hard problem\n\n\n:::\n\nThe `kmeans()` function\n-----------------------------\n\n\n\n\n`kmeans()` is a wrapper for a collection of Algorithms that \nlook like the Lloyd algorithm\n\n\nInitialize \n: Choose $k$ centroids\n\nIterations: Two phases\n\nMovement \n: Assign each sample point to the closest centroid (Assign each sample point to a class in the Voronoi partition defined by the centroids)\n\nUpdate \n: For each class in the current Voronoi partition, update the centroid so as to minimize the *Within Cluster Sum of Squared distances*.\n\n\n\n{{< fa hand-point-right >}} No guarantee to converge to a global optimum!\n\nProceeed by trial and error.\n\nRepeat the algorithm and keep the best result.\n\n\n\nIris data \n----------\n\n::: {.callout-note title='Question'} \n \nRun `kmeans()` on the projection of the Iris dataset  (`data(iris)`) on the `Petal` plane.\n\nCheck `?iris` and [https://en.wikipedia.org/wiki/Iris_flower_data_set](https://en.wikipedia.org/wiki/Iris_flower_data_set) for more on this (historical) dataset. \n\n\n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \nWe look for a partition into three cells.\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(iris)\n\nkms <- iris |> \n  select(starts_with(\"Petal\")) |>\n  kmeans(3)\n\nclass(kms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"kmeans\"\n```\n\n\n:::\n\n```{.r .cell-code}\nsloop::otype(kms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"S3\"\n```\n\n\n:::\n:::\n\nThe result is an object of class `kmeans`. The class is equiped with `broom` methods.  \n\n::: \n:::\n\n\n::: {.callout-note title='Question'} \n\n- Check the *attributes* of object `kms`\n- Unclass the object and check the attributes again.\n \n:::\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n::: {.cell}\n\n```{.r .cell-code}\nattributes(kms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$names\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n\n$class\n[1] \"kmeans\"\n```\n\n\n:::\n\n```{.r .cell-code}\nukms <- unclass(kms)\nattributes(ukms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$names\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"      \n```\n\n\n:::\n\n```{.r .cell-code}\nclass(kms)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"kmeans\"\n```\n\n\n:::\n\n```{.r .cell-code}\nkms_bornagain <- structure(\n  ukms, \n  class=\"kmeans\")\n\nsloop::otype(kms_bornagain)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"S3\"\n```\n\n\n:::\n\n```{.r .cell-code}\nclass(kms_bornagain)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"kmeans\"\n```\n\n\n:::\n:::\n \nObjects of class `kmeans` have two attributes `names`  and `class`. Because of the `class` attribute, objects of class `kmeans`  are not just lists with named elements.   \n\n\n::: \n \n:::\n\nSummarizing a clustering \n-------------------------\n\n::: {.callout-note title=\"Question\"}\n\nCheck the structure of objects of class `kmeans` and use `broom::tidy()` to get a summary. \n\nCompare with `summary()` from base `R`\n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n\n::: {.cell}\n\n```{.r .cell-code}\ndf_centers <- select(iris, starts_with(\"Petal\")) |>\n  kmeans(centers = 3) |> \n  broom::tidy() \n\ndf_centers |>  \n  gt::gt() |>\n  gt::fmt_number(decimals = 2) |>\n  gt::tab_caption(\"Iris clustering in the Petal plane, kmeans with 3 clusters\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"oojdydyngp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oojdydyngp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oojdydyngp thead, #oojdydyngp tbody, #oojdydyngp tfoot, #oojdydyngp tr, #oojdydyngp td, #oojdydyngp th {\n  border-style: none;\n}\n\n#oojdydyngp p {\n  margin: 0;\n  padding: 0;\n}\n\n#oojdydyngp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oojdydyngp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oojdydyngp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oojdydyngp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oojdydyngp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oojdydyngp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oojdydyngp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oojdydyngp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oojdydyngp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oojdydyngp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oojdydyngp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oojdydyngp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oojdydyngp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oojdydyngp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oojdydyngp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oojdydyngp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oojdydyngp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oojdydyngp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oojdydyngp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oojdydyngp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oojdydyngp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oojdydyngp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oojdydyngp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oojdydyngp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oojdydyngp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oojdydyngp .gt_left {\n  text-align: left;\n}\n\n#oojdydyngp .gt_center {\n  text-align: center;\n}\n\n#oojdydyngp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oojdydyngp .gt_font_normal {\n  font-weight: normal;\n}\n\n#oojdydyngp .gt_font_bold {\n  font-weight: bold;\n}\n\n#oojdydyngp .gt_font_italic {\n  font-style: italic;\n}\n\n#oojdydyngp .gt_super {\n  font-size: 65%;\n}\n\n#oojdydyngp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oojdydyngp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oojdydyngp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oojdydyngp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oojdydyngp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oojdydyngp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oojdydyngp .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oojdydyngp .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oojdydyngp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Iris clustering in the Petal plane, kmeans with 3 clusters</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Petal.Length\">Petal.Length</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Petal.Width\">Petal.Width</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"size\">size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"withinss\">withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Petal.Length\" class=\"gt_row gt_right\">4.27</td>\n<td headers=\"Petal.Width\" class=\"gt_row gt_right\">1.34</td>\n<td headers=\"size\" class=\"gt_row gt_right\">52.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">13.06</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"Petal.Length\" class=\"gt_row gt_right\">1.46</td>\n<td headers=\"Petal.Width\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\"size\" class=\"gt_row gt_right\">50.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">2</td></tr>\n    <tr><td headers=\"Petal.Length\" class=\"gt_row gt_right\">5.60</td>\n<td headers=\"Petal.Width\" class=\"gt_row gt_right\">2.04</td>\n<td headers=\"size\" class=\"gt_row gt_right\">48.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">16.29</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">3</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n- How are the rows related to clusters?\n- What are the coordinates good for?\n- What does the `size` column mean?\n- `withinss` stands for *Within Sum of Squares*. How is it computed? Why is it useful?\n\n:::\n\n:::::\n\n\nVisualizing a clustering\n-------------------------\n\n::: {.callout-note  title=\"Question\"}\n\nUse `broom::augment()` and `broom::tidy()` to prepare two dataframes that will allow you to overlay a scatterplot of the dataset and a Voronoï diagram defined by the centers output by `kmeans()`. \n\nCompare the result with `plot()`\n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n\n\n::: {.cell}\n\n```{.r .cell-code}\nq <- kms |> \n  augment(iris) |>\n  ggplot() +\n  aes(x=Petal.Length, \n      y=Petal.Width\n      ) +\n  geom_point(aes(shape=Species), size=1, show.legend = F) +\n  coord_fixed()\n\nqq <-  (q + geom_point(aes(shape=Species, \n                           colour=.cluster), \n                       size=1))+\n  stat_voronoi(data = df_centers,   #<<\n               geom=\"path\",\n               outline=data.frame(x=c(0, 7, 7, 0), \n                                  y=c(0, 0, 3, 3))\n               ) +\n  geom_point(data = df_centers,   #<<\n             colour = \"black\",\n             shape=\"+\",\n             size=5)  \n\nq / qq +\n  plot_annotation(title = \"Kmeans over Iris dataset, k=3\")\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n:::\n\n\n::: {.callout-tip title='Solution'} \n \n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeom_sugar <- list(\n    stat_voronoi(data = df_centers,\n                 geom=\"path\",\n                 alpha=.5,\n                 outline = tribble(~x, ~y,\n                                   0., 0.,\n                                   7., 0.,\n                                   7., 3,\n                                   0., 3) \n                 ),\n    geom_point(data = df_centers,   \n               colour = \"black\",\n               shape=\"+\",\n               size=5),\n    coord_fixed(),\n    labs(col=\"Voronoï cells\")\n)\n```\n:::\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::augment(kms, iris) |>\n  ggplot(aes(x=Petal.Length, y=Petal.Width)) +\n  geom_point(aes(shape=Species, color=.cluster)) +\n  geom_sugar \n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {.callout-tip title='Solution'} \n \n::: {.cell}\n\n```{.r .cell-code}\nkms |> \n  autoplot(data=iris)\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n:::\n\n:::::\n\n::: {.callout-note title=\"Question\"}\n\nRedo the same operations but choose the `Sepal.xxx` dimension.\n\nDesign a function to avoid repetitive coding.  \n\n:::\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n::: {.cell}\n\n```{.r .cell-code}\nplot_km_centroids <- function(augmented_km, centroids, col1, col2){\n\n  outline <- augmented_km |>\n    dplyr::select({{col1}}, {{col2}}) |>\n    dplyr::rename(x={{col1}}, y={{col2}}) |> \n    summarise(across(everything(), .fns=list(\"min\"= min, \"max\"=max), .names=\"{.col}_{.fn}\"))\n\n  tb_outline <- tibble(\n    x = with(outline, c(x_min-1.0, x_max+1.0, x_max+1.0, x_min-1.0)),\n    y = with(outline, rep(c(y_min-1, y_max+1), each=2)),\n    group=rep(1, 4)\n  )\n\n  p <- augmented_km |> \n  ggplot() +\n  aes(\n    x={{col1}}, \n    y={{col2}}) +\n  geom_point(aes(colour=.cluster))  +\n  stat_voronoi(data = centroids,\n               geom=\"path\",\n               outline= tb_outline\n  ) +\n  geom_point(data = centroids,\n             colour = \"black\",\n             shape=\"+\",\n             size=5) +\n  coord_fixed() +\n  theme_minimal()\n\n  if (has_rownames(augmented_km)) {\n    p <- p +\n      ggrepel::geom_label_repel(\n        aes(colour=.cluster, \n            label=`.rownames`))\n  }\n\n  return(p)\n}\n```\n:::\n\n \n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkms <- kmeans(select(iris, Sepal.Length, Sepal.Width), 3)\n\n\nplot_km_centroids(\n  augment(kms, iris), \n  tidy(kms), \n  Sepal.Length, \n  Sepal.Width\n)\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/iriskmeans3-1.png){width=672}\n:::\n:::\n:::::\n\n\nPlaying with $k$ \n-----------------\n\nThe number of cells/clusters may not be given a priori. Conducting clustering using \na method like `kmeans` requires picking a reasonable choice for `k`. \n\n::: {.callout-note}\n\n### Question\n\nPerform kmeans clustering with $k=2$.  Use `glance`, `tidy`, `augment` to discuss the result.\n\n:::\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- select(iris, \n             starts_with(\"Sepal\"))\n\nkms <- kmeans(df, 2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_km_centroids(\n  augment(kms, iris),\n  tidy(kms),\n  Sepal.Length,\n  Sepal.Width\n)\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/iriskmeans2bis-1.png){width=672}\n:::\n:::\n\nWe can compare the spread between inner and outer sum of squares for clusterings \nwith $k \\in 2, 3$. \n\n::: {.cell}\n\n```{.r .cell-code}\nbind_rows(glance(kms),\n          glance(kmeans(df, centers=3,\n              nstart = 32L))) |> \n  mutate(k=c(2, 3))  |>\n  gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"xrzfdzhtdf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xrzfdzhtdf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xrzfdzhtdf thead, #xrzfdzhtdf tbody, #xrzfdzhtdf tfoot, #xrzfdzhtdf tr, #xrzfdzhtdf td, #xrzfdzhtdf th {\n  border-style: none;\n}\n\n#xrzfdzhtdf p {\n  margin: 0;\n  padding: 0;\n}\n\n#xrzfdzhtdf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xrzfdzhtdf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xrzfdzhtdf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xrzfdzhtdf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xrzfdzhtdf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xrzfdzhtdf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xrzfdzhtdf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xrzfdzhtdf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xrzfdzhtdf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xrzfdzhtdf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xrzfdzhtdf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xrzfdzhtdf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xrzfdzhtdf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xrzfdzhtdf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xrzfdzhtdf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xrzfdzhtdf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xrzfdzhtdf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xrzfdzhtdf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xrzfdzhtdf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xrzfdzhtdf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xrzfdzhtdf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xrzfdzhtdf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xrzfdzhtdf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xrzfdzhtdf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xrzfdzhtdf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xrzfdzhtdf .gt_left {\n  text-align: left;\n}\n\n#xrzfdzhtdf .gt_center {\n  text-align: center;\n}\n\n#xrzfdzhtdf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xrzfdzhtdf .gt_font_normal {\n  font-weight: normal;\n}\n\n#xrzfdzhtdf .gt_font_bold {\n  font-weight: bold;\n}\n\n#xrzfdzhtdf .gt_font_italic {\n  font-style: italic;\n}\n\n#xrzfdzhtdf .gt_super {\n  font-size: 65%;\n}\n\n#xrzfdzhtdf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xrzfdzhtdf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xrzfdzhtdf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xrzfdzhtdf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xrzfdzhtdf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xrzfdzhtdf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xrzfdzhtdf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#xrzfdzhtdf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#xrzfdzhtdf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"totss\">totss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"tot.withinss\">tot.withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"betweenss\">betweenss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"iter\">iter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"totss\" class=\"gt_row gt_right\">130.4753</td>\n<td headers=\"tot.withinss\" class=\"gt_row gt_right\">58.2150</td>\n<td headers=\"betweenss\" class=\"gt_row gt_right\">72.26027</td>\n<td headers=\"iter\" class=\"gt_row gt_right\">1</td>\n<td headers=\"k\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"totss\" class=\"gt_row gt_right\">130.4753</td>\n<td headers=\"tot.withinss\" class=\"gt_row gt_right\">37.0507</td>\n<td headers=\"betweenss\" class=\"gt_row gt_right\">93.42456</td>\n<td headers=\"iter\" class=\"gt_row gt_right\">3</td>\n<td headers=\"k\" class=\"gt_row gt_right\">3</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n \n:::\n\n:::::\n\n::: {.callout-note}\n\n### Question\n\nPerform k-means for $k=2, ... 10$, plot within sum of squares as function of $k$. \nComment. \n\n:::\n\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.cell}\n\n```{.r .cell-code}\ntmp <-map_dfr(2:10, ~ glance(kmeans(df, \n                                   centers=.,\n                                   nstart = 32L))) |> \n  rowid_to_column(var=\"k\") |> \n  mutate(k=k+1, across(where(is.numeric), ~ signif(.x, 3))) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmp |>\n  ggplot(aes(x=forcats::as_factor(k), y=tot.withinss/totss)) +\n  geom_col(width=.25) +\n  ggtitle(\"Iris data\", \"WithinSS/Total Sum of Squares as a function of k\") +\n  xlab(\"k\") +\n  ylab(\"Within Clusters Sum of Squares (relative)\") +\n  scale_x_discrete(breaks=as.character(2:10), labels=as.character(2:10))\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/iriswithinss-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkms <- kmeans(df, 4)\niris4 <- broom::augment(kms, iris)\n\n\nplot_km_centroids(\n  augment(kms, iris),\n  tidy(kms),\n  Sepal.Length,\n  Sepal.Width\n)  +\n ggtitle(label=\"Kmeans Iris data\",\n         subtitle=\"k=4\") +\n labs(col=\"Clusters\")\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/iriskmeans4-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::tidy(kmeans(df, 4)) |>\n  gt::gt() |>\n  gt::fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bmxvnvwwij\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bmxvnvwwij table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bmxvnvwwij thead, #bmxvnvwwij tbody, #bmxvnvwwij tfoot, #bmxvnvwwij tr, #bmxvnvwwij td, #bmxvnvwwij th {\n  border-style: none;\n}\n\n#bmxvnvwwij p {\n  margin: 0;\n  padding: 0;\n}\n\n#bmxvnvwwij .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bmxvnvwwij .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bmxvnvwwij .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bmxvnvwwij .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bmxvnvwwij .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bmxvnvwwij .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bmxvnvwwij .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bmxvnvwwij .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bmxvnvwwij .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bmxvnvwwij .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bmxvnvwwij .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bmxvnvwwij .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bmxvnvwwij .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bmxvnvwwij .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bmxvnvwwij .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmxvnvwwij .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bmxvnvwwij .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bmxvnvwwij .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bmxvnvwwij .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmxvnvwwij .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bmxvnvwwij .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmxvnvwwij .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bmxvnvwwij .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmxvnvwwij .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bmxvnvwwij .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bmxvnvwwij .gt_left {\n  text-align: left;\n}\n\n#bmxvnvwwij .gt_center {\n  text-align: center;\n}\n\n#bmxvnvwwij .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bmxvnvwwij .gt_font_normal {\n  font-weight: normal;\n}\n\n#bmxvnvwwij .gt_font_bold {\n  font-weight: bold;\n}\n\n#bmxvnvwwij .gt_font_italic {\n  font-style: italic;\n}\n\n#bmxvnvwwij .gt_super {\n  font-size: 65%;\n}\n\n#bmxvnvwwij .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bmxvnvwwij .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bmxvnvwwij .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bmxvnvwwij .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bmxvnvwwij .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bmxvnvwwij .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bmxvnvwwij .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bmxvnvwwij .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bmxvnvwwij div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sepal.Length\">Sepal.Length</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sepal.Width\">Sepal.Width</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"size\">size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"withinss\">withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Sepal.Length\" class=\"gt_row gt_right\">5.52</td>\n<td headers=\"Sepal.Width\" class=\"gt_row gt_right\">2.61</td>\n<td headers=\"size\" class=\"gt_row gt_right\">33.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">5.97</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"Sepal.Length\" class=\"gt_row gt_right\">5.02</td>\n<td headers=\"Sepal.Width\" class=\"gt_row gt_right\">3.45</td>\n<td headers=\"size\" class=\"gt_row gt_right\">49.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">11.57</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">2</td></tr>\n    <tr><td headers=\"Sepal.Length\" class=\"gt_row gt_right\">6.27</td>\n<td headers=\"Sepal.Width\" class=\"gt_row gt_right\">2.91</td>\n<td headers=\"size\" class=\"gt_row gt_right\">41.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">4.85</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">3</td></tr>\n    <tr><td headers=\"Sepal.Length\" class=\"gt_row gt_right\">7.10</td>\n<td headers=\"Sepal.Width\" class=\"gt_row gt_right\">3.11</td>\n<td headers=\"size\" class=\"gt_row gt_right\">27.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">6.02</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">4</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::::   \n\n\nLloyd's iterations \n---------------------\n\nThe `kmeans` function does not minimize the `kmeans` cost. It offers a collection \nof iterative algorithms that aim at approximately minimizing the cost. \n\n\n::: {.callout-note}\n\nInitialize \n: Choose $k$ centroids\n\nIterations: Two phases\n\nMovement \n: Assign each sample point to the closest centroid (Assign each sample point to a class in the Voronoi partition defined by the centroids)\n\nUpdate \n: For each class in the current Voronoi partition, update the centroid so as to minimize the *Within Cluster Sum of Squared distances*.\n\n\n:::\n\n\n::::: {.content-visible when-profile=\"solution\"}  \n\n::: {.callout-tip title='Solution'} \n \n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkm <- list(centers=df[1:3, ]) # stupid initialization\n\nsequence <- list()\n\nfor (i in 1:20) {\n  km <- kmeans(df,\n               km$centers,\n               algorithm = \"Lloyd\",\n               iter.max = 1)\n  sequence[[length(sequence)+1]] <- force(km)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_voronoi <- function(p, kmscenters, marker){\n  p +\n    geom_point(data=data.frame(kmscenters),         #<<\n               mapping=aes(x=Sepal.Length, y=Sepal.Width),\n               shape=marker,\n               col=\"black\",\n               size=5) +\n    stat_voronoi(data = as.data.frame(kmscenters),  #<<\n                 aes(x=Sepal.Length,y=Sepal.Width),\n                 geom=\"path\",\n                 outline=data.frame(x=c(4, 8, 8, 4),\n                                    y=c(2, 2, 4.5, 4.5)))\n}\n```\n:::\n:::\n\n::: {.callout-tip title='Solution'} \n \n \n\n::: {.cell}\n\n```{.r .cell-code}\ni <- 2\n\np <- broom::augment(sequence[[i]], iris) |>\n  ggplot() +\n  coord_fixed(ratio=1) +\n  geom_point(aes(x=Sepal.Length, y=Sepal.Width, shape=Species, col=.cluster)) +\n  ggtitle(\"Kmeans Lloyd's algorithm\", \"Iris data\")\n\np |>\n  add_voronoi(sequence[[i]]$centers, marker=\"o\") +   #<<\n  labs(colour=paste(\"Cluster, step \", i- 1))\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/lloyd1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ni <- 2\n\n(p %+%\n  broom::augment(sequence[[i]], iris)) |>\n  add_voronoi(sequence[[i]]$centers, marker='+') +   #<<\n  geom_point(data=data.frame(sequence[[2]]$centers),   #<<\n             mapping=aes(x=Sepal.Length, y=Sepal.Width),\n             shape=\"o\", col=\"black\", size=5) +\n  labs(colour=paste(\"Cluster, step \", i- 1))\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {.callout-tip title='Solution'} \n \n\n::: {.cell}\n\n```{.r .cell-code}\ni <- 3\n\n(p %+%\n  broom::augment(sequence[[i]], iris)) |>\n  add_voronoi(sequence[[i]]$centers, marker='+') +   #<<\n  geom_point(data=data.frame(sequence[[2]]$centers),   #<<\n             mapping=aes(x=Sepal.Length, y=Sepal.Width),\n             shape=\"o\", col=\"black\", size=5) +\n  labs(colour=paste(\"Cluster, step \", i- 1))\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/lloyd5-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ni <- 5\n\n(p %+%\n  broom::augment(sequence[[i]], iris)) |>\n  add_voronoi(sequence[[i]]$centers, marker='*') +   #<<\n  geom_point(data=data.frame(sequence[[2]]$centers),   #<<\n             mapping=aes(x=Sepal.Length, y=Sepal.Width),\n             shape=\"o\", col=\"black\",size=5) +\n  labs(colour=paste(\"Cluster, step \", i- 1))\n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/lloyd00-1.png){width=672}\n:::\n:::\n\n:::\n\n:::::\n\n\nRevisiting the `swiss` fertility data\n-------------------------------------\n\n::: {.callout-note title='Question'} \n \nRecall the dataset used in [Lab PCA](/core/labs/lab-pca.qmd)\n\nPerform kmeans clustering in original coordinates and kmeans clustering in the first principal coordinates plane \n\nCompare the results\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"} \n::: {.callout-tip title=\"solution\"} \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(swiss)\n\nswiss_scaled <- swiss |>  \n  select(-Fertility) |> \n  scale() \n\nkm.2.swiss <- swiss_scaled |> \n  kmeans(centers = 2,  nstart = 10L)\n\ndf_centers.2 <- broom::tidy(km.2.swiss)\n```\n:::\n\n\n:::\n\n::: {.callout-tip title=\"solution\"} \n\n::: {.cell}\n\n```{.r .cell-code}\nkm.2.swiss.pca <-  swiss_scaled |>\n  prcomp() |> \n  augment(data=swiss)|> \n  dplyr::select(starts_with(\".fittedPC\")) |> \n  kmeans(centers=2, nstart = 10L)\n\ndf_centers.2.pca <- tidy(km.2.swiss.pca)\n```\n:::\n\n:::\n\n::: {.callout-tip title='Solution'} \n \n::: {.columns}\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_centers.2 |>\n  gt::gt() |> \n  gt::fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hddplukavh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hddplukavh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hddplukavh thead, #hddplukavh tbody, #hddplukavh tfoot, #hddplukavh tr, #hddplukavh td, #hddplukavh th {\n  border-style: none;\n}\n\n#hddplukavh p {\n  margin: 0;\n  padding: 0;\n}\n\n#hddplukavh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hddplukavh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hddplukavh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hddplukavh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hddplukavh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hddplukavh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hddplukavh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hddplukavh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hddplukavh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hddplukavh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hddplukavh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hddplukavh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hddplukavh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hddplukavh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hddplukavh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hddplukavh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hddplukavh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hddplukavh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hddplukavh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hddplukavh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hddplukavh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hddplukavh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hddplukavh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hddplukavh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hddplukavh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hddplukavh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hddplukavh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hddplukavh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hddplukavh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hddplukavh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hddplukavh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hddplukavh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hddplukavh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hddplukavh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hddplukavh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hddplukavh .gt_left {\n  text-align: left;\n}\n\n#hddplukavh .gt_center {\n  text-align: center;\n}\n\n#hddplukavh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hddplukavh .gt_font_normal {\n  font-weight: normal;\n}\n\n#hddplukavh .gt_font_bold {\n  font-weight: bold;\n}\n\n#hddplukavh .gt_font_italic {\n  font-style: italic;\n}\n\n#hddplukavh .gt_super {\n  font-size: 65%;\n}\n\n#hddplukavh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hddplukavh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hddplukavh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hddplukavh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hddplukavh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hddplukavh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hddplukavh .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hddplukavh .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hddplukavh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Agriculture\">Agriculture</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Examination\">Examination</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Education\">Education</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Catholic\">Catholic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Infant.Mortality\">Infant.Mortality</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"size\">size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"withinss\">withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Agriculture\" class=\"gt_row gt_right\">−0.46</td>\n<td headers=\"Examination\" class=\"gt_row gt_right\">0.57</td>\n<td headers=\"Education\" class=\"gt_row gt_right\">0.36</td>\n<td headers=\"Catholic\" class=\"gt_row gt_right\">−0.67</td>\n<td headers=\"Infant.Mortality\" class=\"gt_row gt_right\">−0.17</td>\n<td headers=\"size\" class=\"gt_row gt_right\">28.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">101.66</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\"Agriculture\" class=\"gt_row gt_right\">0.68</td>\n<td headers=\"Examination\" class=\"gt_row gt_right\">−0.83</td>\n<td headers=\"Education\" class=\"gt_row gt_right\">−0.53</td>\n<td headers=\"Catholic\" class=\"gt_row gt_right\">0.99</td>\n<td headers=\"Infant.Mortality\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\"size\" class=\"gt_row gt_right\">19.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">49.26</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">2</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkm.2.swiss |> \n  broom::glance() |>\n  gt::gt() |> \n  gt::fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ixjgyviggj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ixjgyviggj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ixjgyviggj thead, #ixjgyviggj tbody, #ixjgyviggj tfoot, #ixjgyviggj tr, #ixjgyviggj td, #ixjgyviggj th {\n  border-style: none;\n}\n\n#ixjgyviggj p {\n  margin: 0;\n  padding: 0;\n}\n\n#ixjgyviggj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ixjgyviggj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ixjgyviggj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ixjgyviggj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ixjgyviggj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ixjgyviggj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ixjgyviggj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ixjgyviggj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ixjgyviggj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ixjgyviggj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ixjgyviggj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ixjgyviggj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ixjgyviggj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ixjgyviggj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ixjgyviggj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ixjgyviggj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ixjgyviggj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ixjgyviggj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ixjgyviggj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ixjgyviggj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ixjgyviggj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ixjgyviggj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ixjgyviggj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ixjgyviggj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ixjgyviggj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ixjgyviggj .gt_left {\n  text-align: left;\n}\n\n#ixjgyviggj .gt_center {\n  text-align: center;\n}\n\n#ixjgyviggj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ixjgyviggj .gt_font_normal {\n  font-weight: normal;\n}\n\n#ixjgyviggj .gt_font_bold {\n  font-weight: bold;\n}\n\n#ixjgyviggj .gt_font_italic {\n  font-style: italic;\n}\n\n#ixjgyviggj .gt_super {\n  font-size: 65%;\n}\n\n#ixjgyviggj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ixjgyviggj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ixjgyviggj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ixjgyviggj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ixjgyviggj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ixjgyviggj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ixjgyviggj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ixjgyviggj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ixjgyviggj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"totss\">totss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"tot.withinss\">tot.withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"betweenss\">betweenss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"iter\">iter</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"totss\" class=\"gt_row gt_right\">230.00</td>\n<td headers=\"tot.withinss\" class=\"gt_row gt_right\">150.91</td>\n<td headers=\"betweenss\" class=\"gt_row gt_right\">79.09</td>\n<td headers=\"iter\" class=\"gt_row gt_right\">1.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n:::\n\n::: {.column}\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_centers.2.pca |>\n  gt::gt() |> \n  gt::fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pyrreawvqv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pyrreawvqv table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pyrreawvqv thead, #pyrreawvqv tbody, #pyrreawvqv tfoot, #pyrreawvqv tr, #pyrreawvqv td, #pyrreawvqv th {\n  border-style: none;\n}\n\n#pyrreawvqv p {\n  margin: 0;\n  padding: 0;\n}\n\n#pyrreawvqv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pyrreawvqv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pyrreawvqv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pyrreawvqv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pyrreawvqv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pyrreawvqv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pyrreawvqv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pyrreawvqv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pyrreawvqv .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pyrreawvqv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pyrreawvqv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pyrreawvqv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pyrreawvqv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pyrreawvqv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pyrreawvqv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pyrreawvqv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pyrreawvqv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pyrreawvqv .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pyrreawvqv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pyrreawvqv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pyrreawvqv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pyrreawvqv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pyrreawvqv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pyrreawvqv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pyrreawvqv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pyrreawvqv .gt_left {\n  text-align: left;\n}\n\n#pyrreawvqv .gt_center {\n  text-align: center;\n}\n\n#pyrreawvqv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pyrreawvqv .gt_font_normal {\n  font-weight: normal;\n}\n\n#pyrreawvqv .gt_font_bold {\n  font-weight: bold;\n}\n\n#pyrreawvqv .gt_font_italic {\n  font-style: italic;\n}\n\n#pyrreawvqv .gt_super {\n  font-size: 65%;\n}\n\n#pyrreawvqv .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pyrreawvqv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pyrreawvqv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pyrreawvqv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pyrreawvqv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pyrreawvqv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pyrreawvqv .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pyrreawvqv .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pyrreawvqv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fittedPC1\">.fittedPC1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fittedPC2\">.fittedPC2</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fittedPC3\">.fittedPC3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fittedPC4\">.fittedPC4</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".fittedPC5\">.fittedPC5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"size\">size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"withinss\">withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cluster\">cluster</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\".fittedPC1\" class=\"gt_row gt_right\">1.50</td>\n<td headers=\".fittedPC2\" class=\"gt_row gt_right\">0.32</td>\n<td headers=\".fittedPC3\" class=\"gt_row gt_right\">−0.36</td>\n<td headers=\".fittedPC4\" class=\"gt_row gt_right\">−0.02</td>\n<td headers=\".fittedPC5\" class=\"gt_row gt_right\">−0.07</td>\n<td headers=\"size\" class=\"gt_row gt_right\">19.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">49.26</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">1</td></tr>\n    <tr><td headers=\".fittedPC1\" class=\"gt_row gt_right\">−1.02</td>\n<td headers=\".fittedPC2\" class=\"gt_row gt_right\">−0.21</td>\n<td headers=\".fittedPC3\" class=\"gt_row gt_right\">0.25</td>\n<td headers=\".fittedPC4\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\".fittedPC5\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"size\" class=\"gt_row gt_right\">28.00</td>\n<td headers=\"withinss\" class=\"gt_row gt_right\">101.66</td>\n<td headers=\"cluster\" class=\"gt_row gt_center\">2</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkm.2.swiss.pca |> \n  broom::glance() |>\n  gt::gt() |> \n  gt::fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cjsvzkitll\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cjsvzkitll table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cjsvzkitll thead, #cjsvzkitll tbody, #cjsvzkitll tfoot, #cjsvzkitll tr, #cjsvzkitll td, #cjsvzkitll th {\n  border-style: none;\n}\n\n#cjsvzkitll p {\n  margin: 0;\n  padding: 0;\n}\n\n#cjsvzkitll .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cjsvzkitll .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cjsvzkitll .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cjsvzkitll .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cjsvzkitll .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cjsvzkitll .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cjsvzkitll .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cjsvzkitll .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cjsvzkitll .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cjsvzkitll .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cjsvzkitll .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cjsvzkitll .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cjsvzkitll .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cjsvzkitll .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cjsvzkitll .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cjsvzkitll .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cjsvzkitll .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cjsvzkitll .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cjsvzkitll .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cjsvzkitll .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cjsvzkitll .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cjsvzkitll .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cjsvzkitll .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cjsvzkitll .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cjsvzkitll .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cjsvzkitll .gt_left {\n  text-align: left;\n}\n\n#cjsvzkitll .gt_center {\n  text-align: center;\n}\n\n#cjsvzkitll .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cjsvzkitll .gt_font_normal {\n  font-weight: normal;\n}\n\n#cjsvzkitll .gt_font_bold {\n  font-weight: bold;\n}\n\n#cjsvzkitll .gt_font_italic {\n  font-style: italic;\n}\n\n#cjsvzkitll .gt_super {\n  font-size: 65%;\n}\n\n#cjsvzkitll .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cjsvzkitll .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cjsvzkitll .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cjsvzkitll .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cjsvzkitll .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cjsvzkitll .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cjsvzkitll .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#cjsvzkitll .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#cjsvzkitll div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"totss\">totss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"tot.withinss\">tot.withinss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"betweenss\">betweenss</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"iter\">iter</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"totss\" class=\"gt_row gt_right\">230.00</td>\n<td headers=\"tot.withinss\" class=\"gt_row gt_right\">150.91</td>\n<td headers=\"betweenss\" class=\"gt_row gt_right\">79.09</td>\n<td headers=\"iter\" class=\"gt_row gt_right\">1.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n:::\n:::  \n \n:::\n\n::: {.callout-tip title=\"solution\"} \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_km_centroids(\n  broom::augment(km.2.swiss, scale(swiss)),\n  broom::tidy(km.2.swiss), \n  Education, \n  Infant.Mortality\n) +\n  labs(\n    title= \"Kmeans over Swiss dataset, k=2\"\n  ) \n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/kmeans-swiss-individuals-1.png){width=672}\n:::\n:::\n:::\n\n::: {.callout-tip title='Solution'} \n \n::: {.cell}\n\n```{.r .cell-code}\nplot_km_centroids(\n  augment(km.2.swiss.pca,\n         broom::augment(prcomp(swiss_scaled), data=swiss)),\n  tidy(km.2.swiss.pca),\n  .fittedPC1,\n  .fittedPC2\n) + labs(\n      title=\"Kmeans over Swiss dataset, k=2\",\n      subtitle=\"Clustering over the Principal components\"\n  ) \n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/kmeans-swiss-individuals-pca-1.png){width=672}\n:::\n:::\n:::\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n::: {.callout-tip title='Solution'} \n \n::: {.cell}\n\n```{.r .cell-code}\nkm.4.swiss.pca <-  swiss_scaled |>\n  prcomp() |> \n  broom::augment(data=swiss)|> \n  dplyr::select(starts_with(\".fittedPC\")) |> \n  kmeans(centers=4, nstart = 10L)\n\ndf_centers.4.pca <- broom::tidy(km.4.swiss.pca)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_km_centroids(\n  augment(km.4.swiss.pca,\n         broom::augment(prcomp(swiss_scaled), data=swiss)),\n  tidy(km.4.swiss.pca),\n  .fittedPC1,\n  .fittedPC2\n) + labs(\n      title=\"Kmeans over Swiss dataset, k=4\",\n      subtitle=\"Clustering over the Principal components\"\n  ) \n```\n\n::: {.cell-output-display}\n![](lab-kmeans_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: \n:::\n\nRevisiting the `mortality` dataset \n-----------------------------------\n\n::: {.callout-note title='Question'} \n \nRecall the dataset used in [Lab CA](/core/labs/lab-ca-mortality.qmd)\n\nPerform kmeans clustering of categories in the row principal coordinates \nand the column principal coordinates \n\n:::\n\n\n::: {.content-visible when-profile='solution'} \n \n \n:::\n\n\n\n\n\n\nReferences\n----------\n\n[Vignette `k_means` from `tidyclust`](https://tidyclust.tidymodels.org/articles/k_means.html)\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}