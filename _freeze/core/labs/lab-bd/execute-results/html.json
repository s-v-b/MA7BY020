{
  "hash": "06f66bc6e8ac7095a634111982c8cd2f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Bivariate analysis'\ncategories: [Table calculus, '`dplyr`', '`dbplyr`', '`dtplyr`', '`data.table`', '`arrow`']\ndate: \"2026-01-16 10:47:48.683535\"\n\n\nexecute:\n  echo: true\n  eval: false\n  collapse: false\n\n\nformat:\n  html:\n    output-file: lab-bd.html\n  pdf:\n    output-file: lab-bd.pdf\n---\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Ann√©e {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n[https://dbplyr.tidyverse.org](https://dbplyr.tidyverse.org)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(dbplyr, warn.conflicts = FALSE)\nlibrary(DBI)\nlibrary(RPostgreSQL)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncon <- DBI::dbConnect(\n    RPostgreSQL::PostgreSQL(),\n    user=Sys.getenv('USERNAME'),\n    password=rstudioapi::askForPassword(),\n    dbname=\"bd_2023-24\",\n    host=\"localhost\",\n    port=5436\n)\n```\n:::\n\n\n\n## With `DBI::...`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbGetQuery(con, \n    \"SELECT \n        count(*) \n    FROM \n        nycflights.flights ;\"\n)\n```\n:::\n\n\nhttps://dbplyr.tidyverse.org/index.html\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- dbSendQuery(con, \n    \"SELECT \n        origin, \n        count(*) AS n  \n    FROM \n        nycflights.flights\n    GROUP BY \n        origin\"\n)\n\ndf <- dbFetch(res)\n\ndbClearResult(res)\n\nhead(df)\n```\n:::\n\n\n\n## With `dbplyr::...`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbplyr::db_connection_describe(con)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl(con, \n    sql(\n        \"SELECT \n            origin, \n            count(*) AS n  \n        FROM \n            nycflights.flights\n        GROUP BY \n            origin\")\n)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_flights <- tbl(con,I(\"nycflights.flights\"))\npg_airlines <- tbl(con,I(\"nycflights.airlines\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_flights |> \n    count(by=origin)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_flights |> \n    group_by(origin, dest) |> \n    summarise(mean_arr_delay= mean(arr_delay, na.rm=T))\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_flights |> \n    group_by(origin, dest) |> \n    summarise(across(ends_with(\"delay\"), \\(x) mean(x, na.rm=TRUE)))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_airlines |> \n    glimpse()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg_flights |> \n    inner_join(pg_airlines, by=c(\"carrier\")) |> \n    group_by(origin, carrier) |> \n    summarise(N=n(), across(ends_with(\"delay\"), .fns=\\(x) mean(x, na.rm=TRUE), .names=\"Avg {.col}\"))\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbDisconnect(con)\n```\n:::\n\n\nEnjoy!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}