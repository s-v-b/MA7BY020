{
  "hash": "32e87edfe667bb9a62430f3ee25f0a9d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tables manipulation II: window functions \"\ncategories: [Tables, tibbles, dplyr, slider, SQL, Relational Algebra, nycflights13]\n\nexecute:\n  echo: true\n  eval: true\n  collapse: false\n\nformat:\n  html:\n    output-file: lab-tables-slider.html\n    code-fold: true\n  pdf:\n    output-file: lab-tables-slider.pdf\n\ndraft: true\nengine: knitr\n---\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n|                            |\n|:---------------------------|\n| {{< var curriculum >}}     |\n| {{< var university >}}     |\n| Ann√©e {{< var year >}}     |\n| {{< var homepage >}}       |\n| {{< var moodle >}}         |\n\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\n\n\n::: {.callout-important}\n\n### Objectives\n\nThe aim of this lab is to showcase the capabilities of `dplyr` and `slider` to handle window queries on tables. In `R`, tables are basically handled as data frames. Provides a lot of tools to handle data frames. `dplyr` should be thought as a concise and consistent API for performing table calculus (the so-called *relational algebra* from database theory). `dplyr` offers *verbs* that implement the main operations of relational algebra: *projection*,  *selection*,  *joins*,  *grouping*, and *aggregation*. `slider` offers the ability to tune window management, compute \nmoving averages and aggregates with respect to complex windows. This is an essential part of time series analysis.    \n\n\n\n\n:::\n\n\n\n## Setup\n\nWe will use the following packages. If needed, we install them. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nold_theme <- theme_set(theme_minimal())\n```\n:::\n\n\nCheck [nycflights13](https://nycflights13.tidyverse.org) for any explanation concerning the tables and their columns. \n\n## Data loading \n\nWe will use data  from package `nycflights13`. Those data consist of five tables.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nflights <- nycflights13::flights\nweather <- nycflights13::weather\nairports <- nycflights13::airports\nairlines <- nycflights13::airlines\nplanes <- nycflights13::planes\n```\n:::\n\n\n## Comparing flights delays with flights delays during the preceding hour\n\n\nDelays are typically temporally correlated: even once the problem that caused the initial delay has been resolved, later flights are delayed to allow earlier flights to leave. Using `lag()`, explore how the delay of a flight is related to the delay of the immediately preceding flight.\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\" collapse=\"true\"}\n\n:::\n\n:::\n\n\n## Detecting abrupt changes\n\nOur aim is to detect *abrupt changes* in departure delays occurring at \nsome airport. \n\nDefinition of abrupt changes. \n\nExpect result \n\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.callout-tip title=\"Solution\" collapse=\"true\"}\n\n:::\n\n:::\n\n\n## References\n\n\n- [Data transformation cheatsheet](https://rstudio.github.io/cheatsheets/html/data-transformation.html)\n- [R4Data Science Tidy](https://r4ds.had.co.nz/tidy-data.html#tidy-data-1)\n- [Benchmarking](https://h2oai.github.io/db-benchmark/)\n- [`dplyr` and `vctrs`](https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-and-vctrs/)\n- [Posts on `dplyr`](https://www.tidyverse.org/tags/dplyr/)\n- [Window functions on `dplyr`](https://dplyr.tidyverse.org/articles/window-functions.html)\n- [`slider`](https://slider.r-lib.org/index.html)\n- [`slider` vignette](https://cran.r-project.org/web/packages/slider/vignettes/slider.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}